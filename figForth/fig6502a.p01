  29 SSIZE           .equ     128               ;sector size in bytes
  30 NBUF            .equ     8                 ;number of buffers desired in RAM
  32 SECTR           .equ     800               ;sector per drive
  34 SECTL           .equ     1600              ;sector limit for two drives
  36 BMAG            .equ     1056              ;total buffer magnitude, in bytes
  39 BOS             .equ     0x20              ;bottom of data stack, in zero-page.
  40 TOS             .equ     0xA0              ;top of data stack, in zero-page.
  41 N               .equ     TOS+8             ;scratch workspace.
  42 IP              .equ     N+8               ;interpretive pointer.
  43 W               .equ     IP+3              ;code field pointer.
  44 UP              .equ     W+2               ;user area pointer.
  45 XSAVE           .equ     UP+2              ;temporary for X register.
  47 TIBX            .equ     0x0100             ;terminal input buffer of 84 bytes.
  48 ORIG            .equ     0x0400             ;origin of FORTH's Dictionary.
  49 MEM             .equ     0x4000             ;top of assigned memory+1 byte.
  50 UAREA           .equ     MEM-128           ;128 bytes of user area
  51 DAREA           .equ     UAREA-BMAG        ;disk buffer space.
  65                 .code  ORIG             ; User cold entry point
  66 ENTER           nop                     ; Vector to COLD entry
  67                 jmp   COLD+2            ;
  68 REENTR          nop                     ; User Warm entry point
  69                 jmp   WARM              ; Vector to WARM entry
  70                 .wrd  0x0004            ; 6502 in radix-36
  71                 .wrd  0x5ED2            ;
  72                 .wrd  NTOP              ; Name address of MON
  73                 .wrd  0x7F               ;Backspace Character
  75                 .wrd  UAREA             ; Initial User Area
  76                 .wrd  TOS-1             ; Initial Top of Stack
  77                 .wrd  0x1FF             ; Initial Top of Return Stack
  78                 .wrd  TIBX              ; Initial terminal input buffer
  81                 .wrd  31                ; Initial name field width
  82                 .wrd  0                 ; 0.equnod disk, 1.equdisk
  83                 .wrd  TOP               ; Initial fence address
  84                 .wrd  TOP               ; Initial top of dictionary
  85                 .wrd  VL0               ; Initial Vocabulary link ptr.
  92                 nop
  93                 nop
  97 cin             lda     0xF004          ; input one ascii char. to term.
  98                 beq     cin
  99                 rts
 100 cout            and     #0x7F           ; output one ascii char. to term.
 101                 sta     0xF001
 102                 rts
 103 crout           lda     #0x0A           ; terminal return and line feed.
 104                 sta     0xF001
 105                 rts
 110 L22             .byt  0x83,"LI",0xD4      ; <--- name field
 111                 .wrd  00                ; <----- link field, last marked by zero
 112 LIT             .wrd  $+2               ; <----- code address field
 113                 lda   (IP),y            ; <----- start of parameter field
 114                 pha
 115                 inc   IP
 116                 bne   L30
 117                 inc   IP+1
 118 L30             lda   (IP),y
 119 L31             inc   IP
 120                 bne   PUSH
 121                 inc   IP+1
 123 PUSH            dex
 124                 dex
 126 PUT             sta   1,x
 127                 pla
 128                 sta   0,x
 133 NEXT            ldy   #1
 134                 lda   (IP),y            ;Fetch code field address pointed
 135                 sta   W+1               ;to by IP.
 136                 dey
 137                 lda   (IP),y
 138                 sta   W
 140                 clc                     ;Increment IP by two.
 141                 lda   IP
 142                 adc   #2
 143                 sta   IP
 144                 bcc   L54
 145                 inc   IP+1
 146 L54             jmp   W-1               ;Jump to an indirect jump (W) which
 152 L35             .byt  0x84,"CLI",0xD4
 153                 .wrd  L22               ;Link to LIT
 154 CLIT            .wrd  $+2
 155                 lda   (IP),y
 156                 pha
 157                 tya
 158                 beq   L31               ;a forced branch into LIT
 162 SETUP           asl   a
 163                 sta   N-1
 164 L63             lda   0,x
 165                 sta   N,y
 166                 inx
 167                 iny
 168                 cpy   N-1
 169                 bne   L63
 170                 ldy   #0
 171                 rts
 176 L75             .byt  0x87,"EXECUT",0xC5
 177                 .wrd  L35               ;link to CLIT
 178 EXEC            .wrd  $+2
 179                 lda   0,x
 180                 sta   W
 181                 lda   1,x
 182                 sta   W+1
 183                 inx
 184                 inx
 185                 jmp   W-1               ;to JMP (W) in z-page
 190 L89             .byt  0x86,"BRANC",0xC8
 191                 .wrd  L75               ;link to EXCECUTE
 192 BRAN            .wrd  $+2
 193                 clc
 194                 lda   (IP),y
 195                 adc   IP
 196                 pha
 197                 iny
 198                 lda   (IP),y
 199                 adc   IP+1
 200                 sta   IP+1
 201                 pla
 202                 sta   IP
 203                 jmp   NEXT+2
 208 L107            .byt  0x87,"0BRANC",0xC8
 209                 .wrd  L89               ;link to BRANCH
 210 ZBRAN           .wrd  $+2
 211                 inx
 212                 inx
 213                 lda   0xFE,x
 214                 ora   0xFF,x
 215                 beq   BRAN+2
 217 BUMP            clc
 218                 lda   IP
 219                 adc   #2
 220                 sta   IP
 221                 bcc   L122
 222                 inc   IP+1
 223 L122            jmp   NEXT
 228 L127            .byt  0x86,"(LOOP",0xA9
 229                 .wrd  L107              ;link to 0BRANCH
 230 PLOOP           .wrd  L130
 231 L130            stx   XSAVE
 232                 tsx
 233                 inc   0x101,x
 234                 bne   PL1
 235                 inc   0x102,x
 237 PL1             clc
 238                 lda   0x103,x
 239                 sbc   0x101,x
 240                 lda   0x104,x
 241                 sbc   0x102,x
 243 PL2             ldx   XSAVE
 244                 asl   a
 245                 bcc   BRAN+2
 246                 pla
 247                 pla
 248                 pla
 249                 pla
 250                 jmp   BUMP
 255 L154            .byt  0x87,"(+LOOP",0xA9
 256                 .wrd  L127              ;link to (loop)
 257 PPLOO           .wrd  $+2
 258                 inx
 259                 inx
 260                 stx   XSAVE
 261                 lda   0xFF,x
 262                 pha
 263                 pha
 264                 lda   0xFE,x
 265                 tsx
 266                 inx
 267                 inx
 268                 clc
 269                 adc   0x101,x
 270                 sta   0x101,x
 271                 pla
 272                 adc   0x102,x
 273                 sta   0x102,x
 274                 pla
 275                 bpl   PL1
 276                 clc
 277                 lda   0x101,x
 278                 sbc   0x103,x
 279                 lda   0x102,x
 280                 sbc   0x104,x
 281                 jmp   PL2
 286 L185            .byt  0x84,"(DO",0xA9
 287                 .wrd  L154              ;link to (+LOOP)
 288 PDO             .wrd  $+2
 289                 lda   3,x
 290                 pha
 291                 lda   2,x
 292                 pha
 293                 lda   1,x
 294                 pha
 295                 lda   0,x
 296                 pha
 298 POPTWO          inx
 299                 inx
 303 POP             inx
 304                 inx
 305                 jmp   NEXT
 310 L207            .byt  0x81,0xC9
 311                 .wrd  L185              ;link to (DO)
 312 I               .wrd  R+2               ;share the code for R
 317 L214            .byt  0x85,"DIGI",0xD4
 318                 .wrd  L207              ;link to I
 319 DIGIT           .wrd  $+2
 320                 sec
 321                 lda   2,x
 322                 sbc   #0x30
 323                 bmi   L234
 324                 cmp   #0xA
 325                 bmi   L227
 326                 sec
 327                 sbc   #7
 328                 cmp   #0xA
 329                 bmi   L234
 330 L227            cmp   0,x
 331                 bpl   L234
 332                 sta   2,x
 333                 lda   #1
 334                 pha
 335                 tya
 336                 jmp   PUT               ;exit true with converted value
 337 L234            tya
 338                 pha
 339                 inx
 340                 inx
 341                 jmp   PUT               ;exit false with bad conversion
 346 L243            .byt  0x86,"(FIND",0xA9
 347                 .wrd  L214              ;Link to DIGIT
 348 PFIND           .wrd  $+2
 349                 lda   #2
 350                 jsr   SETUP
 351                 stx   XSAVE
 352 L249            ldy   #0
 353                 lda   (N),y
 354                 eor   (N+2),y
 357                 and   #0x3F
 358                 bne   L281
 359 L254            iny
 360                 lda   (N),y
 361                 eor   (N+2),y
 362                 asl   a
 363                 bne   L280
 364                 bcc   L254
 365                 ldx   XSAVE
 366                 dex
 367                 dex
 368                 dex
 369                 dex
 370                 clc
 371                 tya
 372                 adc   #5
 373                 adc   N
 374                 sta   2,x
 375                 ldy   #0
 376                 tya
 377                 adc   N+1
 378                 sta   3,x
 379                 sty   1,x
 380                 lda   (N),y
 381                 sta   0,x
 382                 lda   #1
 383                 pha
 384                 jmp   PUSH
 385 L280            bcs   L284
 386 L281            iny
 387                 lda   (N),y
 388                 bpl   L281
 389 L284            iny
 390                 lda   (N),y
 391                 tax
 392                 iny
 393                 lda   (N),y
 394                 sta   N+1
 395                 stx   N
 396                 ora   N
 397                 bne   L249
 398                 ldx   XSAVE
 399                 lda   #0
 400                 pha
 401                 jmp   PUSH              ;exit false upon reading null link
 406 L301            .byt  0x87,"ENCLOS",0xC5
 407                 .wrd  L243              ;link to (FIND)
 408 ENCL            .wrd  $+2
 409                 lda   #2
 410                 jsr   SETUP
 411                 txa
 412                 sec
 413                 sbc   #8
 414                 tax
 415                 sty   3,x
 416                 sty   1,x
 417                 dey
 418 L313            iny
 419                 lda   (N+2),y
 420                 cmp   N
 421                 beq   L313
 422                 sty   4,x
 423 L318            lda   (N+2),y
 424                 bne   L327
 425                 sty   2,x
 426                 sty   0,x
 427                 tya
 428                 cmp   4,x
 429                 bne   L326
 430                 inc   2,x
 431 L326            jmp   NEXT
 432 L327            sty   2,x
 433                 iny
 434                 cmp   N
 435                 bne   L318
 436                 sty   0,x
 437                 jmp   NEXT
 442 L337            .byt  0x84,"EMI",0xD4
 443                 .wrd  L301              ;link to ENCLOSE
 444 EMIT            .wrd  XEMIT             ;Vector to code for KEY
 449 L344            .byt  0x83,"KE",0xD9
 450                 .wrd  L337              ;link to EMIT
 451 KEY             .wrd  XKEY              ;Vector to code for KEY
 456 L351            .byt  0x89,"?TERMINA",0xCC
 457                 .wrd  L344              ;link to KEY
 458 QTERM           .wrd  XQTER             ;Vector to code for ?TERMINAL
 467 L358            .byt  0x82,"C",0xD2
 468                 .wrd  L351              ;link to ?TERMINAL
 469 CR              .wrd  XCR               ;Vector to code for CR
 474 L365            .byt  0x85,"CMOV",0xC5
 475                 .wrd  L358              ;link to CR
 476 CMOVE           .wrd  $+2
 477                 lda   #3
 478                 jsr   SETUP
 479 L370            cpy   N
 480                 bne   L375
 481                 dec   N+1
 482                 bpl   L375
 483                 jmp   NEXT
 484 L375            lda   (N+4),y
 485                 sta   (N+2),y
 486                 iny
 487                 bne   L370
 488                 inc   N+5
 489                 inc   N+3
 490                 jmp   L370
 495 L386            .byt  0x82,"U",0xAA
 496                 .wrd  L365              ;link to CMOVE
 497 USTAR           .wrd  $+2
 528                 lda   #0                ;in some implementations TYA can be used since NEXT leaves Y.equ0x00
 529                 sta   N
 530                 ldy   #16
 531                 lsr   3,x
 532                 ror   2,x
 533 L1              bcc   L2
 534                 clc
 535                 sta   N+1               ;PHA
 536                 lda   N
 537                 adc   0,x
 538                 sta   N
 539                 lda   N+1               ;PLA
 540                 adc   1,x
 541 L2              ror   a
 542                 ror   N
 543                 ror   3,x
 544                 ror   2,x
 545                 dey
 546                 bne   L1
 547                 sta   1,x
 548                 lda   N
 549                 sta   0,x
 550                 jmp   NEXT
 556 L418            .byt  0x82,"U",0xAF
 557                 .wrd  L386              ;link to U*
 558 USLAS           .wrd  $+2
 591                 sec                     ;Modified code - dr
 592                 lda   2,x               ;Subtract hi cell of dividend by
 593                 sbc   0,x               ;divisor to see if there's an overflow condition.
 594                 lda   3,x
 595                 sbc   1,x
 596                 bcs   oflow             ;Branch if /0 or overflow.
 597                 lda   #0x11              ;Loop 17x.
 598                 sta   N                 ;Use N for loop counter.
 599 loopp           rol   4,x               ;Rotate dividend lo cell left one bit.
 600                 rol   5,x
 601                 dec   N                 ;Decrement loop counter.
 602                 beq   endd              ;If we're done, then branch to end.
 603                 rol   2,x               ;Otherwise rotate dividend hi cell left one bit.
 604                 rol   3,x
 606                 pha
 607                 lda #0
 608                 sta N+1
 609                 pla
 611                 rol   N+1               ;Rotate the bit carried out of above into N+1.
 612                 sec
 613                 lda   2,x               ;Subtract dividend hi cell minus divisor.
 614                 sbc   0,x
 615                 sta   N+2               ;Put result temporarily in N+2 (lo byte)
 616                 lda   3,x
 617                 sbc   1,x
 618                 tay                     ;and Y (hi byte).
 619                 lda   N+1               ;Remember now to bring in the bit carried out above.
 620                 sbc   #0x00
 621                 bcc   loopp
 622                 lda   N+2               ;If that didn't cause a borrow,
 623                 sta   2,x               ;make the result from above to
 624                 sty   3,x               ;be the new dividend hi cell
 625                 bcs   loopp             ;and then brach up.  (NMOS 6502 can use BCS here.)
 626 oflow           lda   #0xFF              ;If overflow or /0 condition found,
 627                 sta   2,x               ;just put FFFF in both the remainder
 628                 sta   3,x
 629                 sta   4,x               ;and the quotient.
 630                 sta   5,x
 631 endd            inx                     ;When you're done, show one less cell on data stack,
 632                 inx                     ;(INX INX is exactly what the Forth word DROP does)
 633                 jmp   SWAP+2            ;and swap the two top cells to put quotient on top.
 639 L453            .byt  0x83,"AN",0xC4
 640                 .wrd  L418              ;link to U/
 641 ANDD            .wrd  $+2
 642                 lda   0,x
 643                 and   2,x
 644                 pha
 645                 lda   1,x
 646                 and   3,x
 648 BINARY          inx
 649                 inx
 650                 jmp   PUT
 655 L469            .byt  0x82,"O",0xD2
 656                 .wrd  L453              ;link to AND
 657 OR              .wrd  $+2
 658                 lda   0,x
 659                 ora   2,x
 660                 pha
 661                 lda   1,x
 662                 ora   3,x
 663                 inx
 664                 inx
 665                 jmp   PUT
 670 L484            .byt  0x83,"XO",0xD2
 671                 .wrd  L469              ;link to OR
 672 XOR             .wrd  $+2
 673                 lda   0,x
 674                 eor   2,x
 675                 pha
 676                 lda   1,x
 677                 eor   3,x
 678                 inx
 679                 inx
 680                 jmp   PUT
 685 L499            .byt  0x83,"SP",0xC0
 686                 .wrd  L484              ;link  to XOR
 687 SPAT            .wrd  $+2
 688                 txa
 690 PUSHOA          pha
 691                 lda   #0
 692                 jmp   PUSH
 698 L511            .byt  0x83,"SP",0xA1
 699                 .wrd  L499              ;link to SP@
 700 SPSTO           .wrd  $+2
 701                 ldy   #6
 702                 lda   (UP),y            ;load data stack pointer (X reg) from
 703                 tax                     ;silent user variable S0.
 704                 jmp   NEXT
 709 L522            .byt  0x83,"RP",0xA1
 710                 .wrd  L511              ;link to SP!
 711 RPSTO           .wrd  $+2
 712                 stx   XSAVE             ;load return stack pointer (machine
 713                 ldy   #8                ;stack pointer) from silent user
 714                 lda   (UP),y            ;VARIABLE R0
 715                 tax
 716                 txs
 717                 ldx   XSAVE
 718                 jmp   NEXT
 723 L536            .byt  0x82,";",0xD3
 724                 .wrd  L522              ;link to RP!
 725 SEMIS           .wrd  $+2
 726                 pla
 727                 sta   IP
 728                 pla
 729                 sta   IP+1
 730                 jmp   NEXT
 735 L548            .byt  0x85,"LEAV",0xC5
 736                 .wrd  L536              ;link to ;S
 737 LEAVE           .wrd  $+2
 738                 stx   XSAVE
 739                 tsx
 740                 lda   0x101,x
 741                 sta   0x103,x
 742                 lda   0x102,x
 743                 sta   0x104,x
 744                 ldx   XSAVE
 745                 jmp   NEXT
 750 L563            .byt  0x82,">",0xD2
 751                 .wrd  L548              ;link to LEAVE
 752 TOR             .wrd  $+2
 753                 lda   1,x               ;move high byte
 754                 pha
 755                 lda   0,x               ;then low byte
 756                 pha                     ;to return stack
 757                 inx
 758                 inx                     ;popping off data stack
 759                 jmp   NEXT
 764 L577            .byt  0x82,"R",0xBE
 765                 .wrd  L563              ;link to >R
 766 RFROM           .wrd  $+2
 767                 dex                     ;make room on data stack
 768                 dex
 769                 pla                     ;high byte
 770                 sta   0,x
 771                 pla                     ;then low byte
 772                 sta   1,x               ;restored to data stack
 773                 jmp   NEXT
 778 L591            .byt  0x81,0xD2
 779                 .wrd  L577              ;link to R>
 780 R               .wrd  $+2
 781                 stx   XSAVE
 782                 tsx                     ;address return stack
 783                 lda   0x101,x            ;copy bottom value
 784                 pha                     ;to data stack
 785                 lda   0x102,x
 786                 ldx   XSAVE
 787                 jmp   PUSH
 792 L605            .byt  0x82,"0",0xBD
 793                 .wrd  L591              ;link to R
 794 ZEQU            .wrd  $+2
 795                 lda   1,x               ;Corrected from FD3/2 p69
 796                 sty   1,x
 797                 ora   0,x
 798                 bne   L613
 799                 iny
 800 L613            sty   0,x
 801                 jmp   NEXT
 806 L619            .byt  0x82,"0",0xBC
 807                 .wrd  L605              ;link to 0.equ
 808 ZLESS           .wrd  $+2
 809                 asl   1,x
 810                 tya
 811                 rol   a
 812                 sty   1,x
 813                 sta   0,x
 814                 jmp   NEXT
 819 L632            .byt  0x81,0xAB
 820                 .wrd  L619              ;link to V-ADJ
 821 PLUS            .wrd  $+2
 822                 clc
 823                 lda   0,x
 824                 adc   2,x
 825                 sta   2,x
 826                 lda   1,x
 827                 adc   3,x
 828                 sta   3,x
 829                 inx
 830                 inx
 831                 jmp   NEXT
 836 L649            .byt  0x82,"D",0xAB
 837                 .wrd  L632              ;LINK TO +
 838 DPLUS           .wrd  $+2
 839                 clc
 840                 lda   2,x
 841                 adc   6,x
 842                 sta   6,x
 843                 lda   3,x
 844                 adc   7,x
 845                 sta   7,x
 846                 lda   0,x
 847                 adc   4,x
 848                 sta   4,x
 849                 lda   1,x
 850                 adc   5,x
 851                 sta   5,x
 852                 jmp   POPTWO
 857 L670            .byt  0x85,"MINU",0xD3
 858                 .wrd  L649              ;link to D+
 859 MINUS           .wrd  $+2
 860                 sec
 861                 tya
 862                 sbc   0,x
 863                 sta   0,x
 864                 tya
 865                 sbc   1,x
 866                 sta   1,x
 867                 jmp   NEXT
 872 L685            .byt  0x86,"DMINU",0xD3
 873                 .wrd  L670              ;link to  MINUS
 874 DMINU           .wrd  $+2
 875                 sec
 876                 tya
 877                 sbc   2,x
 878                 sta   2,x
 879                 tya
 880                 sbc   3,x
 881                 sta   3,x
 882                 jmp   MINUS+3
 887 L700            .byt  0x84,"OVE",0xD2
 888                 .wrd  L685              ;link to DMINUS
 889 OVER            .wrd  $+2
 890                 lda   2,x
 891                 pha
 892                 lda   3,x
 893                 jmp   PUSH
 898 L711            .byt  0x84,"DRO",0xD0
 899                 .wrd  L700              ;link to OVER
 900 DROP            .wrd  POP
 905 L718            .byt  0x84,"SWA",0xD0
 906                 .wrd  L711              ;link to DROP
 907 SWAP            .wrd  $+2
 908                 lda   2,x
 909                 pha
 910                 lda   0,x
 911                 sta   2,x
 912                 lda   3,x
 913                 ldy   1,x
 914                 sty   3,x
 915                 jmp   PUT
 920 L733            .byt  0x83,"DU",0xD0
 921                 .wrd  L718              ;link to SWAP
 922 DUP             .wrd  $+2
 923                 lda   0,x
 924                 pha
 925                 lda   1,x
 926                 jmp   PUSH
 931 L744            .byt  0x82,"+",0xA1
 932                 .wrd  L733              ;link to DUP
 933 PSTOR           .wrd  $+2
 934                 clc
 935                 lda   (0,x)             ;fetch 16 bit value addressed by
 936                 adc   2,x               ;bottom of  stack, adding to
 937                 sta   (0,x)             ;second item on stack, and return
 938                 inc   0,x               ;to memory
 939                 bne   L754
 940                 inc   1,x
 941 L754            lda   (0,x)
 942                 adc   3,x
 943                 sta   (0,x)
 944                 jmp   POPTWO
 949 L762            .byt  0x81,"TOGGL",0xC5
 950                 .wrd  L744              ;link to +!
 951 TOGGL           .wrd  $+2
 952                 lda   (2,x)             ;complement bits in memory address
 953                 eor   0,x               ;second on stack, by pattern on
 954                 sta   (2,x)             ;bottom of stack.
 955                 jmp   POPTWO
 960 L773            .byt  0x81,0xC0
 961                 .wrd  L762              ;link to TOGGLE
 962 AT              .wrd  $+2
 963                 lda   (0,x)
 964                 pha
 965                 inc   0,x
 966                 bne   L781
 967                 inc   1,x
 968 L781            lda   (0,x)
 969                 jmp   PUT
 974 L787            .byt  0x82,"C",0xC0
 975                 .wrd  L773              ;link to @
 976 CAT             .wrd  $+2
 977                 lda   (0,x)             ;fetch byte addressed by bottom of
 978                 sta   0,x               ;stack to stack, zeroing the high
 979                 sty   1,x               ;byte
 980                 jmp   NEXT
 985 L798            .byt  0x81,0xA1
 986                 .wrd  L787              ;link to C@
 987 STORE           .wrd  $+2
 988                 lda   2,x
 989                 sta   (0,x)             ;store second 16bit value on stack
 990                 inc   0,x               ;to memory as addressed by bottom
 991                 bne   L806              ;of stack.
 992                 inc   1,x
 993 L806            lda   3,x
 994                 sta   (0,x)
 995                 jmp   POPTWO
1000 L813            .byt  0x82,"C",0xA1
1001                 .wrd  L798              ;link to !
1002 CSTOR           .wrd  $+2
1003                 lda   2,x
1004                 sta   (0,x)
1005                 jmp   POPTWO
1010 L823            .byt  0xC1,0xBA
1011                 .wrd  L813              ;link to C!
1012 COLON           .wrd  DOCOL
1013                 .wrd  QEXEC
1014                 .wrd  SCSP
1015                 .wrd  CURR
1016                 .wrd  AT
1017                 .wrd  CON
1018                 .wrd  STORE
1019                 .wrd  CREAT
1020                 .wrd  RBRAC
1021                 .wrd  PSCOD
1023 DOCOL           lda   IP+1
1024                 pha
1025                 lda   IP
1026                 pha
1027                 clc
1028                 lda   W
1029                 adc   #2
1030                 sta   IP
1031                 tya
1032                 adc   W+1
1033                 sta   IP+1
1034                 jmp   NEXT
1039 L853            .byt  0xC1,0xBB
1040                 .wrd  L823              ;link to :
1041                 .wrd  DOCOL
1042                 .wrd  QCSP
1043                 .wrd  COMP
1044                 .wrd  SEMIS
1045                 .wrd  SMUDG
1046                 .wrd  LBRAC
1047                 .wrd  SEMIS
1052 L867            .byt  0x88,"CONSTAN",0xD4
1053                 .wrd  L853              ;link to ;
1054 CONST           .wrd  DOCOL
1055                 .wrd  CREAT
1056                 .wrd  SMUDG
1057                 .wrd  COMMA
1058                 .wrd  PSCOD
1060 DOCON           ldy   #2
1061                 lda   (W),y
1062                 pha
1063                 iny
1064                 lda   (W),y
1065                 jmp   PUSH
1070 L885            .byt  0x88,"VARIABL",0xC5
1071                 .wrd  L867              ;link to CONSTANT
1072 VAR             .wrd  DOCOL
1073                 .wrd  CONST
1074                 .wrd  PSCOD
1076 DOVAR           clc
1077                 lda   W
1078                 adc   #2
1079                 pha
1080                 tya
1081                 adc   W+1
1082                 jmp   PUSH
1087 L902            .byt  0x84,"USE",0xD2
1088                 .wrd  L885              ;link to VARIABLE
1089 USER            .wrd  DOCOL
1090                 .wrd  CONST
1091                 .wrd  PSCOD
1093 DOUSE           ldy   #2
1094                 clc
1095                 lda   (W),y
1096                 adc   UP
1097                 pha
1098                 lda   #0
1099                 adc   UP+1
1100                 jmp   PUSH
1105 L920            .byt  0x81,0xB0
1106                 .wrd  L902              ;link to USER
1107 ZERO            .wrd  DOCON
1108                 .wrd  0
1113 L928            .byt  0x81,0xB1
1114                 .wrd  L920              ;link to 0
1115 ONE             .wrd  DOCON
1116                 .wrd  1
1121 L936            .byt  0x81,0xB2
1122                 .wrd  L928              ;link to 1
1123 TWO             .wrd  DOCON
1124                 .wrd  2
1129 L944            .byt  0x81,0xB3
1130                 .wrd  L936              ;link to 2
1131 THREE           .wrd  DOCON
1132                 .wrd  3
1137 L952            .byt  0x82,"B",0xCC
1138                 .wrd  L944              ;link to 3
1139 BL              .wrd  DOCON
1140                 .wrd  0x20
1145 L960            .byt  0x83,"C/",0xCC
1146                 .wrd  L952              ;link to BL
1147 CSLL            .wrd  DOCON
1148                 .wrd  64
1153 L968            .byt  0x85,"FIRS",0xD4
1154                 .wrd  L960              ;link to C/L
1155 FIRST           .wrd  DOCON
1156                 .wrd  DAREA             ;bottom of disk buffer area
1161 L976            .byt  0x85,"LIMI",0xD4
1162                 .wrd  L968              ;link to FIRST
1163 LIMIT           .wrd  DOCON
1164                 .wrd  UAREA             ;buffers end at user area
1170 L984            .byt  0x85,"B/BU",0xC6
1171                 .wrd  L976              ;link to LIMIT
1172 BBUF            .wrd  DOCON
1173                 .wrd  SSIZE             ;sector size
1179 L992            .byt  0x85,"B/SC",0xD2
1180                 .wrd  L984              ;link to B/BUF
1181 BSCR            .wrd  DOCON
1182                 .wrd  8                 ;blocks to make one screen
1192 L1000           .byt  0x87,"+ORIGI",0xCE
1193                 .wrd  L992              ;link to B/SCR
1194 PORIG           .wrd  DOCOL
1195                 .wrd  LIT,ORIG
1196                 .wrd  PLUS
1197                 .wrd  SEMIS
1202 L1010           .byt  0x83,"TI",0xC2
1203                 .wrd  L1000             ;link to +ORIGIN
1204 TIB             .wrd  DOUSE
1205                 .byt  0xA
1210 L1018           .byt  0x85,"WIDT",0xC8
1211                 .wrd  L1010             ;link to TIB
1212 WIDTH           .wrd  DOUSE
1213                 .byt  0xC
1218 L1026           .byt  0x87,"WARNIN",0xC7
1219                 .wrd  L1018             ;link to WIDTH
1220 WARN            .wrd  DOUSE
1221                 .byt  0xE
1226 L1034           .byt  0x85,"FENC",0xC5
1227                 .wrd  L1026             ;link to WARNING
1228 FENCE           .wrd  DOUSE
1229                 .byt  0x10
1235 L1042           .byt  0x82,"D",0xD0
1236                 .wrd  L1034             ;link to FENCE
1237 DP              .wrd  DOUSE
1238                 .byt  0x12
1243 L1050           .byt  0x88,"VOC-LIN",0xCB
1244                 .wrd  L1042             ;link to DP
1245 VOCL            .wrd  DOUSE
1246                 .byt  0x14
1251 L1058           .byt  0x83,"BL",0xCB
1252                 .wrd  L1050             ;link to VOC-LINK
1253 BLK             .wrd  DOUSE
1254                 .byt  0x16
1259 L1066           .byt  0x82,"I",0xCE
1260                 .wrd  L1058             ;link to BLK
1261 IN              .wrd  DOUSE
1262                 .byt  0x18
1267 L1074           .byt  0x83,"OU",0xD4
1268                 .wrd  L1066             ;link to IN
1269 OUT             .wrd  DOUSE
1270                 .byt  0x1A
1275 L1082           .byt  0x83,"SC",0xD2
1276                 .wrd  L1074             ;link to OUT
1277 SCR             .wrd  DOUSE
1278                 .byt  0x1C
1283 L1090           .byt  0x86,"OFFSE",0xD4
1284                 .wrd  L1082             ;link to SCR
1285 OFSET           .wrd  DOUSE
1286                 .byt  0x1E
1291 L1098           .byt  0x87,"CONTEX",0xD4
1292                 .wrd  L1090             ;link to OFFSET
1293 CON             .wrd  DOUSE
1294                 .byt  0x20
1299 L1106           .byt  0x87,"CURREN",0xD4
1300                 .wrd  L1098             ;link to CONTEXT
1301 CURR            .wrd  DOUSE
1302                 .byt  0x22
1307 L1114           .byt  0x85,"STAT",0xC5
1308                 .wrd  L1106             ;link to CURRENT
1309 STATE           .wrd  DOUSE
1310                 .byt  0x24
1315 L1122           .byt  0x84,"BAS",0xC5
1316                 .wrd  L1114             ;link to STATE
1317 BASE            .wrd  DOUSE
1318                 .byt  0x26
1323 L1130           .byt  0x83,"DP",0xCC
1324                 .wrd  L1122             ;link to BASE
1325 DPL             .wrd  DOUSE
1326                 .byt  0x28
1331 L1138           .byt  0x83,"FL",0xC4
1332                 .wrd  L1130             ;link to DPL
1333 FLD             .wrd  DOUSE
1334                 .byt  0x2A
1341 L1146           .byt  0x83,"CS",0xD0
1342                 .wrd  L1138             ;link to FLD
1343 CSP             .wrd  DOUSE
1344                 .byt  0x2C
1349 L1154           .byt  0x82,"R",0xA3
1350                 .wrd  L1146             ;link to CSP
1351 RNUM            .wrd  DOUSE
1352                 .byt  0x2E
1357 L1162           .byt  0x83,"HL",0xC4
1358                 .wrd  L1154             ;link to R#
1359 HLD             .wrd  DOUSE
1360                 .byt  0x30
1365 L1170           .byt  0x82,"1",0xAB
1366                 .wrd  L1162             ;link to HLD
1367 ONEP            .wrd  DOCOL
1368                 .wrd  ONE
1369                 .wrd  PLUS
1370                 .wrd  SEMIS
1375 L1180           .byt  0x82,"2",0xAB
1376                 .wrd  L1170             ;link to 1+
1377 TWOP            .wrd  DOCOL
1378                 .wrd  TWO
1379                 .wrd  PLUS
1380                 .wrd  SEMIS
1385 L1190           .byt  0x84,"HER",0xC5
1386                 .wrd  L1180             ;link to 2+
1387 HERE            .wrd  DOCOL
1388                 .wrd  DP
1389                 .wrd  AT
1390                 .wrd  SEMIS
1395 L1200           .byt  0x85,"ALLO",0xD4
1396                 .wrd  L1190             ;link to HERE
1397 ALLOT           .wrd  DOCOL
1398                 .wrd  DP
1399                 .wrd  PSTOR
1400                 .wrd  SEMIS
1405 L1210           .byt  0x81,0xAC
1406                 .wrd  L1200             ;link to ALLOT
1407 COMMA           .wrd  DOCOL
1408                 .wrd  HERE
1409                 .wrd  STORE
1410                 .wrd  TWO
1411                 .wrd  ALLOT
1412                 .wrd  SEMIS
1417 L1222           .byt  0x82,"C",0xAC
1418                 .wrd  L1210             ;link to ,
1419 CCOMM           .wrd  DOCOL
1420                 .wrd  HERE
1421                 .wrd  CSTOR
1422                 .wrd  ONE
1423                 .wrd  ALLOT
1424                 .wrd  SEMIS
1429 L1234           .byt  0x81,0xAD
1430                 .wrd  L1222             ;link to C,
1431 SUB             .wrd  DOCOL
1432                 .wrd  MINUS
1433                 .wrd  PLUS
1434                 .wrd  SEMIS
1439 L1244           .byt  0x81,0xBD
1440                 .wrd  L1234             ;link to -
1441 EQUAL           .wrd  DOCOL
1442                 .wrd  SUB
1443                 .wrd  ZEQU
1444                 .wrd  SEMIS
1449 L1246           .byt  0x82,"U",0xBC
1450                 .wrd  L1244             ;link to =
1451 ULESS           .wrd  DOCOL
1452                 .wrd  SUB               ;subtract two values
1453                 .wrd  ZLESS             ;test sign
1454                 .wrd  SEMIS
1460 L1254           .byt  0x81,0xBC
1461                 .wrd  L1246             ;link to U<
1462 LESS            .wrd  $+2
1463                 sec
1464                 lda   2,x
1465                 sbc   0,x               ;subtract
1466                 lda   3,x
1467                 sbc   1,x
1468                 sty   3,x               ;zero high byte
1469                 bvc   L1258
1470                 eor   #0x80              ;correct overflow
1471 L1258           bpl   L1260
1472                 iny                     ;invert boolean
1473 L1260           sty   2,x               ;leave boolean
1474                 jmp   POP
1478 L1264           .byt  0x81,0xBE
1479                 .wrd  L1254             ;link to <
1480 GREAT           .wrd  DOCOL
1481                 .wrd  SWAP
1482                 .wrd  LESS
1483                 .wrd  SEMIS
1488 L1274           .byt  0x83,"RO",0xD4
1489                 .wrd  L1264             ;link to >
1490 ROT             .wrd  DOCOL
1491                 .wrd  TOR
1492                 .wrd  SWAP
1493                 .wrd  RFROM
1494                 .wrd  SWAP
1495                 .wrd  SEMIS
1500 L1286           .byt  0x85,"SPAC",0xC5
1501                 .wrd  L1274             ;link to ROT
1502 SPACE           .wrd  DOCOL
1503                 .wrd  BL
1504                 .wrd  EMIT
1505                 .wrd  SEMIS
1510 L1296           .byt  0x84,"-DU",0xD0
1511                 .wrd  L1286             ;link to SPACE
1512 DDUP            .wrd  DOCOL
1513                 .wrd  DUP
1514                 .wrd  ZBRAN
1515 L1301           .wrd  0x4                ;L1303-L1301
1516                 .wrd  DUP
1517 L1303           .wrd  SEMIS
1522 L1308           .byt  0x88,"TRAVERS",0xC5
1523                 .wrd  L1296             ;link to -DUP
1524 TRAV            .wrd  DOCOL
1525                 .wrd  SWAP
1526 L1312           .wrd  OVER
1527                 .wrd  PLUS
1528                 .wrd  CLIT
1529                 .byt  0x7F
1531                 .wrd  OVER
1532                 .wrd  CAT
1533                 .wrd  LESS
1535                 .wrd  ZBRAN
1536 L1320           .wrd  L1312-L1320   ;0xFFF1
1537                 .wrd  SWAP
1538                 .wrd  DROP
1539                 .wrd  SEMIS
1544 L1328           .byt  0x86,"LATES",0xD4
1545                 .wrd  L1308             ;link to TRAVERSE
1546 LATES           .wrd  DOCOL
1547                 .wrd  CURR
1548                 .wrd  AT
1549                 .wrd  AT
1550                 .wrd  SEMIS
1556 L1339           .byt  0x83,"LF",0xC1
1557                 .wrd  L1328             ;link to LATEST
1558 LFA             .wrd  DOCOL
1559                 .wrd  CLIT
1560                 .byt  4
1561                 .wrd  SUB
1562                 .wrd  SEMIS
1567 L1350           .byt  0x83,"CF",0xC1
1568                 .wrd  L1339             ;link to LFA
1569 CFA             .wrd  DOCOL
1570                 .wrd  TWO
1571                 .wrd  SUB
1572                 .wrd  SEMIS
1577 L1360           .byt  0x83,"NF",0xC1
1578                 .wrd  L1350             ;link to CFA
1579 NFA             .wrd  DOCOL
1580                 .wrd  CLIT
1581                 .byt  0x5
1582                 .wrd  SUB
1583                 .wrd  LIT,0xFFFF
1584                 .wrd  TRAV
1585                 .wrd  SEMIS
1590 L1373           .byt  0x83,"PF",0xC1
1591                 .wrd  L1360             ;link to NFA
1592 PFA             .wrd  DOCOL
1593                 .wrd  ONE
1594                 .wrd  TRAV
1595                 .wrd  CLIT
1596                 .byt  5
1597                 .wrd  PLUS
1598                 .wrd  SEMIS
1603 L1386           .byt  0x84,"!CS",0xD0
1604                 .wrd  L1373             ;link to PFA
1605 SCSP            .wrd  DOCOL
1606                 .wrd  SPAT
1607                 .wrd  CSP
1608                 .wrd  STORE
1609                 .wrd  SEMIS
1614 L1397           .byt  0x86,"?ERRO",0xD2
1615                 .wrd  L1386             ;link to !CSP
1616 QERR            .wrd  DOCOL
1617                 .wrd  SWAP
1618                 .wrd  ZBRAN
1619 L1402           .wrd  8                 ;L1406-L1402
1620                 .wrd  ERROR
1621                 .wrd  BRAN
1622 L1405           .wrd  4                 ;L1407-L1405
1623 L1406           .wrd  DROP
1624 L1407           .wrd  SEMIS
1629 L1412           .byt  0x85,"?COM",0xD0
1630                 .wrd  L1397             ;link to ?ERROR
1631 QCOMP           .wrd  DOCOL
1632                 .wrd  STATE
1633                 .wrd  AT
1634                 .wrd  ZEQU
1635                 .wrd  CLIT
1636                 .byt  0x11
1637                 .wrd  QERR
1638                 .wrd  SEMIS
1643 L1426           .byt  0x85,"?EXE",0xC3
1644                 .wrd  L1412             ;link to ?COMP
1645 QEXEC           .wrd  DOCOL
1646                 .wrd  STATE
1647                 .wrd  AT
1648                 .wrd  CLIT
1649                 .byt  0x12
1650                 .wrd  QERR
1651                 .wrd  SEMIS
1656 L1439           .byt  0x86,"?PAIR",0xD3
1657                 .wrd  L1426             ;link to ?EXEC
1658 QPAIR           .wrd  DOCOL
1659                 .wrd  SUB
1660                 .wrd  CLIT
1661                 .byt  0x13
1662                 .wrd  QERR
1663                 .wrd  SEMIS
1668 L1451           .byt  0x84,"?CS",0xD0
1669                 .wrd  L1439             ;link to ?PAIRS
1670 QCSP            .wrd  DOCOL
1671                 .wrd  SPAT
1672                 .wrd  CSP
1673                 .wrd  AT
1674                 .wrd  SUB
1675                 .wrd  CLIT
1676                 .byt  0x14
1677                 .wrd  QERR
1678                 .wrd  SEMIS
1683 L1466           .byt  0x88,"?LOADIN",0xC7
1684                 .wrd  L1451             ;link to ?CSP
1685 QLOAD           .wrd  DOCOL
1686                 .wrd  BLK
1687                 .wrd  AT
1688                 .wrd  ZEQU
1689                 .wrd  CLIT
1690                 .byt  0x16
1691                 .wrd  QERR
1692                 .wrd  SEMIS
1697 L1480           .byt  0x87,"COMPIL",0xC5
1698                 .wrd  L1466             ;link to ?LOADING
1699 COMP            .wrd  DOCOL
1700                 .wrd  QCOMP
1701                 .wrd  RFROM
1702                 .wrd  DUP
1703                 .wrd  TWOP
1704                 .wrd  TOR
1705                 .wrd  AT
1706                 .wrd  COMMA
1707                 .wrd  SEMIS
1712 L1495           .byt  0xC1,0x.byt
1713                 .wrd  L1480             ;link to COMPILE
1714 LBRAC           .wrd  DOCOL
1715                 .wrd  ZERO
1716                 .wrd  STATE
1717                 .wrd  STORE
1718                 .wrd  SEMIS
1723 L1507           .byt  0x81,0xDD
1724                 .wrd  L1495             ;link to [
1725 RBRAC           .wrd  DOCOL
1726                 .wrd  CLIT
1727                 .byt  0xC0
1728                 .wrd  STATE
1729                 .wrd  STORE
1730                 .wrd  SEMIS
1735 L1519           .byt  0x86,"SMUDG",0xC5
1736                 .wrd  L1507             ;link to ]
1737 SMUDG           .wrd  DOCOL
1738                 .wrd  LATES
1739                 .wrd  CLIT
1740                 .byt  0x20
1741                 .wrd  TOGGL
1742                 .wrd  SEMIS
1747 L1531           .byt  0x83,"HE",0xD8
1748                 .wrd  L1519             ;link to SMUDGE
1749 HEX             .wrd  DOCOL
1750                 .wrd  CLIT
1751                 .byt  16
1752                 .wrd  BASE
1753                 .wrd  STORE
1754                 .wrd  SEMIS
1759 L1543           .byt  0x87,"DECIMA",0xCC
1760                 .wrd  L1531             ;link to HEX
1761 DECIM           .wrd  DOCOL
1762                 .wrd  CLIT
1763                 .byt  10
1764                 .wrd  BASE
1765                 .wrd  STORE
1766                 .wrd  SEMIS
1773 L1555           .byt  0x87,"(;CODE",0xA9
1774                 .wrd  L1543             ;link to DECIMAL
1775 PSCOD           .wrd  DOCOL
1776                 .wrd  RFROM
1777                 .wrd  LATES
1778                 .wrd  PFA
1779                 .wrd  CFA
1780                 .wrd  STORE
1781                 .wrd  SEMIS
1786 L1568           .byt  0xC5,";COD",0xC5
1787                 .wrd  L1555             ;link to (;CODE)
1788 SEMICOD         .wrd  DOCOL
1789                 .wrd  QCSP
1790                 .wrd  COMP
1791                 .wrd  PSCOD
1792                 .wrd  LBRAC
1793                 .wrd  SMUDG
1794                 .wrd  SEMIS
1799 L1582           .byt  0x87,"<BUILD",0xD3
1800                 .wrd  L1568             ;link to ;CODE
1801 BUILD           .wrd  DOCOL
1802                 .wrd  ZERO
1803                 .wrd  CONST
1804                 .wrd  SEMIS
1809 L1592           .byt  0x85,"DOES",0xBE
1810                 .wrd  L1582             ;link to <BUILDS
1811 DOES            .wrd  DOCOL
1812                 .wrd  RFROM
1813                 .wrd  LATES
1814                 .wrd  PFA
1815                 .wrd  STORE
1816                 .wrd  PSCOD
1818 DODOE           lda   IP+1
1819                 pha
1820                 lda   IP
1821                 pha
1822                 ldy   #2
1823                 lda   (W),y
1824                 sta   IP
1825                 iny
1826                 lda   (W),y
1827                 sta   IP+1
1828                 clc
1829                 lda   W
1830                 adc   #4
1831                 pha
1832                 lda   W+1
1833                 adc   #0
1834                 jmp   PUSH
1839 L1622           .byt  0x85,"COUN",0xD4
1840                 .wrd  L1592             ;link to DOES>
1841 COUNT           .wrd  DOCOL
1842                 .wrd  DUP
1843                 .wrd  ONEP
1844                 .wrd  SWAP
1845                 .wrd  CAT
1846                 .wrd  SEMIS
1851 L1634           .byt  0x84,"TYP",0xC5
1852                 .wrd  L1622             ;link to COUNT
1853 TYPE            .wrd  DOCOL
1854                 .wrd  DDUP
1855                 .wrd  ZBRAN
1856 L1639           .wrd  0x18               ;L1651-L1639
1857                 .wrd  OVER
1858                 .wrd  PLUS
1859                 .wrd  SWAP
1860                 .wrd  PDO
1861 L1644           .wrd  I
1862                 .wrd  CAT
1863                 .wrd  EMIT
1864                 .wrd  PLOOP
1865 L1648           .wrd  0xFFF8             ;L1644-L1648
1866                 .wrd  BRAN
1867 L1650           .wrd  0x4                ;L1652-L1650
1868 L1651           .wrd  DROP
1869 L1652           .wrd  SEMIS
1874 L1657           .byt  0x89,"-TRAILIN",0xC7
1875                 .wrd  L1634             ;link to TYPE
1876 DTRAI           .wrd  DOCOL
1877                 .wrd  DUP
1878                 .wrd  ZERO
1879                 .wrd  PDO
1880 L1663           .wrd  OVER
1881                 .wrd  OVER
1882                 .wrd  PLUS
1883                 .wrd  ONE
1884                 .wrd  SUB
1885                 .wrd  CAT
1886                 .wrd  BL
1887                 .wrd  SUB
1888                 .wrd  ZBRAN
1889 L1672           .wrd  8                 ;L1676-L1672
1890                 .wrd  LEAVE
1891                 .wrd  BRAN
1892 L1675           .wrd  6                 ;L1678-L1675
1893 L1676           .wrd  ONE
1894                 .wrd  SUB
1895 L1678           .wrd  PLOOP
1896 L1679           .wrd  0xFFE0             ;L1663-L1679
1897                 .wrd  SEMIS
1901 L1685           .byt  0x84,"(.",0x22,0xA9  ;0x84 (." 0xA9
1902                 .wrd  L1657             ;link to -TRAILING
1903 PDOTQ           .wrd  DOCOL
1904                 .wrd  R
1905                 .wrd  COUNT
1906                 .wrd  DUP
1907                 .wrd  ONEP
1908                 .wrd  RFROM
1909                 .wrd  PLUS
1910                 .wrd  TOR
1911                 .wrd  TYPE
1912                 .wrd  SEMIS
1917 L1701           .byt  0xC2,".",0xA2
1918                 .wrd  L1685             ;link to PDOTQ
1919                 .wrd  DOCOL
1920                 .wrd  CLIT
1921                 .byt  0x22
1922                 .wrd  STATE
1923                 .wrd  AT
1924                 .wrd  ZBRAN
1925 L1709           .wrd  0x14               ;L1719-L1709
1926                 .wrd  COMP
1927                 .wrd  PDOTQ
1928                 .wrd  WORD
1929                 .wrd  HERE
1930                 .wrd  CAT
1931                 .wrd  ONEP
1932                 .wrd  ALLOT
1933                 .wrd  BRAN
1934 L1718           .wrd  0xA                ;L1723-L1718
1935 L1719           .wrd  WORD
1936                 .wrd  HERE
1937                 .wrd  COUNT
1938                 .wrd  TYPE
1939 L1723           .wrd  SEMIS
1944 L1729           .byt  0x86,"EXPEC",0xD4
1945                 .wrd  L1701             ;link to ."
1946 EXPEC           .wrd  DOCOL
1947                 .wrd  OVER
1948                 .wrd  PLUS
1949                 .wrd  OVER
1950                 .wrd  PDO
1951 L1736           .wrd  KEY
1952                 .wrd  DUP
1953                 .wrd  CLIT
1954                 .byt  0xE
1955                 .wrd  PORIG
1956                 .wrd  AT
1957                 .wrd  EQUAL
1958                 .wrd  ZBRAN
1959 L1744           .wrd  0x1F               ;L1760-L1744
1960                 .wrd  DROP
1961                 .wrd  CLIT
1962                 .byt  8                  ;Backspace!
1963                 .wrd  OVER
1964                 .wrd  I
1965                 .wrd  EQUAL
1966                 .wrd  DUP
1967                 .wrd  RFROM
1968                 .wrd  TWO
1969                 .wrd  SUB
1970                 .wrd  PLUS
1971                 .wrd  TOR
1972                 .wrd  SUB
1973                 .wrd  BRAN
1974 L1759           .wrd  0x27               ;L1779-L1759
1975 L1760           .wrd  DUP
1976                 .wrd  CLIT
1977                 .byt  0x0D
1978                 .wrd  EQUAL
1979                 .wrd  ZBRAN
1980 L1765           .wrd  0x0E               ;L1772-L1765
1981                 .wrd  LEAVE
1982                 .wrd  DROP
1983                 .wrd  BL
1984                 .wrd  ZERO
1985                 .wrd  BRAN
1986 L1771           .wrd  4                  ;L1773-L1771
1987 L1772           .wrd  DUP
1988 L1773           .wrd  I
1989                 .wrd  CSTOR
1990                 .wrd  ZERO
1991                 .wrd  I
1992                 .wrd  ONEP
1993                 .wrd  STORE
1994 L1779           .wrd  EMIT
1995                 .wrd  PLOOP
1996 L1781           .wrd  0xFFA9
1997                 .wrd  DROP              ;L1736-L1781
1998                 .wrd  SEMIS
2003 L1788           .byt  0x85,"QUER",0xD9
2004                 .wrd  L1729             ;link to EXPECT
2005 QUERY           .wrd  DOCOL
2006                 .wrd  TIB
2007                 .wrd  AT
2008                 .wrd  CLIT
2009                 .byt  80                ;80 characters from terminal
2010                 .wrd  EXPEC
2011                 .wrd  ZERO
2012                 .wrd  IN
2013                 .wrd  STORE
2014                 .wrd  SEMIS
2020 L1804           .byt  0xC1,0x80
2021                 .wrd  L1788             ;link to QUERY
2022                 .wrd  DOCOL
2023                 .wrd  BLK
2024                 .wrd  AT
2025                 .wrd  ZBRAN
2026 L1810           .wrd  0x2A               ;L1830-l1810
2027                 .wrd  ONE
2028                 .wrd  BLK
2029                 .wrd  PSTOR
2030                 .wrd  ZERO
2031                 .wrd  IN
2032                 .wrd  STORE
2033                 .wrd  BLK
2034                 .wrd  AT
2035                 .wrd  ZERO,BSCR
2036                 .wrd  USLAS
2037                 .wrd  DROP              ;fixed from model
2038                 .wrd  ZEQU
2039                 .wrd  ZBRAN
2040 L1824           .wrd  8                 ;L1828-L1824
2041                 .wrd  QEXEC
2042                 .wrd  RFROM
2043                 .wrd  DROP
2044 L1828           .wrd  BRAN
2045 L1829           .wrd  6                 ;L1832-L1829
2046 L1830           .wrd  RFROM
2047                 .wrd  DROP
2048 L1832           .wrd  SEMIS
2054 L1838           .byt  0x84,"FIL",0xCC
2055                 .wrd  L1804             ;link to X
2056 FILL            .wrd  DOCOL
2057                 .wrd  SWAP
2058                 .wrd  TOR
2059                 .wrd  OVER
2060                 .wrd  CSTOR
2061                 .wrd  DUP
2062                 .wrd  ONEP
2063                 .wrd  RFROM
2064                 .wrd  ONE
2065                 .wrd  SUB
2066                 .wrd  CMOVE
2067                 .wrd  SEMIS
2072 L1856           .byt  0x85,"ERAS",0xC5
2073                 .wrd  L1838             ;link to FILL
2074 ERASE           .wrd  DOCOL
2075                 .wrd  ZERO
2076                 .wrd  FILL
2077                 .wrd  SEMIS
2082 L1866           .byt  0x86,"BLANK",0xD3
2083                 .wrd  L1856             ;link to ERASE
2084 BLANK           .wrd  DOCOL
2085                 .wrd  BL
2086                 .wrd  FILL
2087                 .wrd  SEMIS
2092 L1876           .byt  0x84,"HOL",0xC4
2093                 .wrd  L1866             ;link to BLANKS
2094 HOLD            .wrd  DOCOL
2095                 .wrd  LIT,0xFFFF
2096                 .wrd  HLD
2097                 .wrd  PSTOR
2098                 .wrd  HLD
2099                 .wrd  AT
2100                 .wrd  CSTOR
2101                 .wrd  SEMIS
2106 L1890           .byt  0x83,"PA",0xC4
2107                 .wrd  L1876             ;link to HOLD
2108 PAD             .wrd  DOCOL
2109                 .wrd  HERE
2110                 .wrd  CLIT
2111                 .byt  68                ;PAD is 68 bytes above here.
2112                 .wrd  PLUS
2113                 .wrd  SEMIS
2118 L1902           .byt  0x84,"WOR",0xC4
2119                 .wrd  L1890             ;link to PAD
2120 WORD            .wrd  DOCOL
2121                 .wrd  BLK
2122                 .wrd  AT
2123                 .wrd  ZBRAN
2124 L1908           .wrd  0xC                ;L1914-L1908
2125                 .wrd  BLK
2126                 .wrd  AT
2127                 .wrd  BLOCK
2128                 .wrd  BRAN
2129 L1913           .wrd  0x6                ;L1916-L1913
2130 L1914           .wrd  TIB
2131                 .wrd  AT
2132 L1916           .wrd  IN
2133                 .wrd  AT
2134                 .wrd  PLUS
2135                 .wrd  SWAP
2136                 .wrd  ENCL
2137                 .wrd  HERE
2138                 .wrd  CLIT
2139                 .byt  0x22
2140                 .wrd  BLANK
2141                 .wrd  IN
2142                 .wrd  PSTOR
2143                 .wrd  OVER
2144                 .wrd  SUB
2145                 .wrd  TOR
2146                 .wrd  R
2147                 .wrd  HERE
2148                 .wrd  CSTOR
2149                 .wrd  PLUS
2150                 .wrd  HERE
2151                 .wrd  ONEP
2152                 .wrd  RFROM
2153                 .wrd  CMOVE
2154                 .wrd  SEMIS
2159 L1943           .byt  0x85,"UPPE",0xD2
2160                 .wrd  L1902             ;link to WORD
2161 UPPER           .wrd  DOCOL
2162                 .wrd  OVER              ;This routine converts text to U case
2163                 .wrd  PLUS              ;It allows interpretation from a term.
2164                 .wrd  SWAP              ;without a shift-lock.
2165                 .wrd  PDO
2166 L1950           .wrd  I
2167                 .wrd  CAT
2168                 .wrd  CLIT
2169                 .byt  0x5F
2170                 .wrd  GREAT
2171                 .wrd  ZBRAN
2172 L1956           .wrd  9                  ;L1961-L1956
2173                 .wrd  I
2174                 .wrd  CLIT
2175                 .byt  0x20
2176                 .wrd  TOGGL
2177 L1961           .wrd  PLOOP
2178 L1962           .wrd  0xFFEA             ;L1950-L1962
2179                 .wrd  SEMIS
2184 L1968           .byt  0x88,"(NUMBER",0xA9
2185                 .wrd  L1943             ;link to UPPER
2186 PNUMB           .wrd  DOCOL
2187 L1971           .wrd  ONEP
2188                 .wrd  DUP
2189                 .wrd  TOR
2190                 .wrd  CAT
2191                 .wrd  BASE
2192                 .wrd  AT
2193                 .wrd  DIGIT
2194                 .wrd  ZBRAN
2195 L1979           .wrd  0x2C               ;L2001-L1979
2196                 .wrd  SWAP
2197                 .wrd  BASE
2198                 .wrd  AT
2199                 .wrd  USTAR
2200                 .wrd  DROP
2201                 .wrd  ROT
2202                 .wrd  BASE
2203                 .wrd  AT
2204                 .wrd  USTAR
2205                 .wrd  DPLUS
2206                 .wrd  DPL
2207                 .wrd  AT
2208                 .wrd  ONEP
2209                 .wrd  ZBRAN
2210 L1994           .wrd  8                 ;L1998-L1994
2211                 .wrd  ONE
2212                 .wrd  DPL
2213                 .wrd  PSTOR
2214 L1998           .wrd  RFROM
2215                 .wrd  BRAN
2216 L2000           .wrd  0xFFC6             ;L1971-L2000
2217 L2001           .wrd  RFROM
2218                 .wrd  SEMIS
2223 L2007           .byt  0x86,"NUMBE",0xD2
2224                 .wrd  L1968             ;link to (NUMBER)
2225 NUMBER          .wrd  DOCOL
2226                 .wrd  ZERO
2227                 .wrd  ZERO
2228                 .wrd  ROT
2229                 .wrd  DUP
2230                 .wrd  ONEP
2231                 .wrd  CAT
2232                 .wrd  CLIT
2233                 .byt  0x2D
2234                 .wrd  EQUAL
2235                 .wrd  DUP
2236                 .wrd  TOR
2237                 .wrd  PLUS
2238                 .wrd  LIT,0xFFFF
2239 L2023           .wrd  DPL
2240                 .wrd  STORE
2241                 .wrd  PNUMB
2242                 .wrd  DUP
2243                 .wrd  CAT
2244                 .wrd  BL
2245                 .wrd  SUB
2246                 .wrd  ZBRAN
2247 L2031           .wrd  0x15               ;L2042-L2031
2248                 .wrd  DUP
2249                 .wrd  CAT
2250                 .wrd  CLIT
2251                 .byt  0x2E
2252                 .wrd  SUB
2253                 .wrd  ZERO
2254                 .wrd  QERR
2255                 .wrd  ZERO
2256                 .wrd  BRAN
2257 L2041           .wrd  0xFFDD             ;L2023-L2041
2258 L2042           .wrd  DROP
2259                 .wrd  RFROM
2260                 .wrd  ZBRAN
2261 L2045           .wrd  4                  ;L2047-L2045
2262                 .wrd  DMINU
2263 L2047           .wrd  SEMIS
2268 L2052           .byt  0x85,"-FIN",0xC4
2269                 .wrd  L2007             ;link to NUMBER
2270 DFIND           .wrd  DOCOL
2271                 .wrd  BL
2272                 .wrd  WORD
2273                 .wrd  HERE              ;)
2274                 .wrd  COUNT             ;|- Optional allowing free use of low
2275                 .wrd  UPPER             ;)  case from terminal
2276                 .wrd  HERE
2277                 .wrd  CON
2278                 .wrd  AT
2279                 .wrd  AT
2280                 .wrd  PFIND
2281                 .wrd  DUP
2282                 .wrd  ZEQU
2283                 .wrd  ZBRAN
2284 L2068           .wrd  0xA                ;L2073-L2068
2285                 .wrd  DROP
2286                 .wrd  HERE
2287                 .wrd  LATES
2288                 .wrd  PFIND
2289 L2073           .wrd  SEMIS
2294 L2078           .byt  0x87,"(ABORT",0xA9
2295                 .wrd  L2052             ;link to -FIND
2296 PABOR           .wrd  DOCOL
2297                 .wrd  ABORT
2298                 .wrd  SEMIS
2303 L2087           .byt  0x85,"ERRO",0xD2
2304                 .wrd  L2078             ;link to (ABORT)
2305 ERROR           .wrd  DOCOL
2306                 .wrd  WARN
2307                 .wrd  AT
2308                 .wrd  ZLESS
2309                 .wrd  ZBRAN
2310 L2094           .wrd  0x4                ;L2096-L2094
2311                 .wrd  PABOR
2312 L2096           .wrd  HERE
2313                 .wrd  COUNT
2314                 .wrd  TYPE
2315                 .wrd  PDOTQ
2316                 .byt  4,"  ? "
2317                 .wrd  MESS
2318                 .wrd  SPSTO
2319                 .wrd  DROP,DROP         ;make room for 2 error values
2320                 .wrd  IN
2321                 .wrd  AT
2322                 .wrd  BLK
2323                 .wrd  AT
2324                 .wrd  QUIT
2325                 .wrd  SEMIS
2330 L2113           .byt  0x83,"ID",0xAE
2331                 .wrd  L2087             ;link to ERROR
2332 IDDOT           .wrd  DOCOL
2333                 .wrd  PAD
2334                 .wrd  CLIT
2335                 .byt  0x20
2336                 .wrd  CLIT
2337                 .byt  0x5F
2338                 .wrd  FILL
2339                 .wrd  DUP
2340                 .wrd  PFA
2341                 .wrd  LFA
2342                 .wrd  OVER
2343                 .wrd  SUB
2344                 .wrd  PAD
2345                 .wrd  SWAP
2346                 .wrd  CMOVE
2347                 .wrd  PAD
2348                 .wrd  COUNT
2349                 .wrd  CLIT
2350                 .byt  0x1F
2351                 .wrd  ANDD
2352                 .wrd  TYPE
2353                 .wrd  SPACE
2354                 .wrd  SEMIS
2359 L2142           .byt  0x86,"CREAT",0xC5
2360                 .wrd  L2113             ;link to ID
2361 CREAT           .wrd  DOCOL
2362                 .wrd  TIB               ;)
2363                 .wrd  HERE              ;|
2364                 .wrd  CLIT              ;|  6502 only, assures
2365                 .byt  0xA0               ;|  room exists in dict.
2366                 .wrd  PLUS              ;|
2367                 .wrd  ULESS             ;|
2368                 .wrd  TWO               ;|
2369                 .wrd  QERR              ;)
2370                 .wrd  DFIND
2371                 .wrd  ZBRAN
2372 L2155           .wrd  0x0F
2373                 .wrd  DROP
2374                 .wrd  NFA
2375                 .wrd  IDDOT
2376                 .wrd  CLIT
2377                 .byt  4
2378                 .wrd  MESS
2379                 .wrd  SPACE
2380 L2163           .wrd  HERE
2381                 .wrd  DUP
2382                 .wrd  CAT
2383                 .wrd  WIDTH
2384                 .wrd  AT
2385                 .wrd  MIN
2386                 .wrd  ONEP
2387                 .wrd  ALLOT
2388                 .wrd  DP                ;)
2389                 .wrd  CAT               ;| 6502 only. The code field
2390                 .wrd  CLIT              ;| must not straddle page
2391                 .byt  0xFD               ;| boundaries
2392                 .wrd  EQUAL             ;|
2393                 .wrd  ALLOT             ;)
2394                 .wrd  DUP
2395                 .wrd  CLIT
2396                 .byt  0xA0
2397                 .wrd  TOGGL
2398                 .wrd  HERE
2399                 .wrd  ONE
2400                 .wrd  SUB
2401                 .wrd  CLIT
2402                 .byt  0x80
2403                 .wrd  TOGGL
2404                 .wrd  LATES
2405                 .wrd  COMMA
2406                 .wrd  CURR
2407                 .wrd  AT
2408                 .wrd  STORE
2409                 .wrd  HERE
2410                 .wrd  TWOP
2411                 .wrd  COMMA
2412                 .wrd  SEMIS
2417 L2200           .byt  0xC9,"[COMPILE",0xDD
2418                 .wrd  L2142             ;link to CREATE
2419                 .wrd  DOCOL
2420                 .wrd  DFIND
2421                 .wrd  ZEQU
2422                 .wrd  ZERO
2423                 .wrd  QERR
2424                 .wrd  DROP
2425                 .wrd  CFA
2426                 .wrd  COMMA
2427                 .wrd  SEMIS
2432 L2216           .byt  0xC7,"LITERA",0xCC
2433                 .wrd  L2200             ;link to [COMPILE]
2434 LITER           .wrd  DOCOL
2435                 .wrd  STATE
2436                 .wrd  AT
2437                 .wrd  ZBRAN
2438 L2222           .wrd  8                 ;L2226-L2222
2439                 .wrd  COMP
2440                 .wrd  LIT
2441                 .wrd  COMMA
2442 L2226           .wrd  SEMIS
2447 L2232           .byt  0xC8,"DLITERA",0xCC
2448                 .wrd  L2216             ;link to LITERAL
2449 DLIT            .wrd  DOCOL
2450                 .wrd  STATE
2451                 .wrd  AT
2452                 .wrd  ZBRAN
2453 L2238           .wrd  8                 ;L2242-L2238
2454                 .wrd  SWAP
2455                 .wrd  LITER
2456                 .wrd  LITER
2457 L2242           .wrd  SEMIS
2462 L2248           .byt  0x86,"?STAC",0xCB
2463                 .wrd  L2232             ;link to DLITERAL
2464 QSTAC           .wrd  DOCOL
2465                 .wrd  CLIT
2466                 .byt  TOS
2467                 .wrd  SPAT
2468                 .wrd  ULESS
2469                 .wrd  ONE
2470                 .wrd  QERR
2471                 .wrd  SPAT
2472                 .wrd  CLIT
2473                 .byt  BOS
2474                 .wrd  ULESS
2475                 .wrd  CLIT
2476                 .byt  7
2477                 .wrd  QERR
2478                 .wrd  SEMIS
2483 L2269           .byt  0x89,"INTERPRE",0xD4
2484                 .wrd  L2248             ;link to ?STACK
2485 INTER           .wrd  DOCOL
2486 L2272           .wrd  DFIND
2487                 .wrd  ZBRAN
2488 L2274           .wrd  0x1E               ;L2289-L2274
2489                 .wrd  STATE
2490                 .wrd  AT
2491                 .wrd  LESS
2492                 .wrd  ZBRAN
2493 L2279           .wrd  0xA                ;L2284-L2279
2494                 .wrd  CFA
2495                 .wrd  COMMA
2496                 .wrd  BRAN
2497 L2283           .wrd  0x6                ;L2286-L2283
2498 L2284           .wrd  CFA
2499                 .wrd  EXEC
2500 L2286           .wrd  QSTAC
2501                 .wrd  BRAN
2502 L2288           .wrd  0x1C               ;L2302-L2288
2503 L2289           .wrd  HERE
2504                 .wrd  NUMBER
2505                 .wrd  DPL
2506                 .wrd  AT
2507                 .wrd  ONEP
2508                 .wrd  ZBRAN
2509 L2295           .wrd  8                 ;L2299-L2295
2510                 .wrd  DLIT
2511                 .wrd  BRAN
2512 L2298           .wrd  0x6                ;L2301-L2298
2513 L2299           .wrd  DROP
2514                 .wrd  LITER
2515 L2301           .wrd  QSTAC
2516 L2302           .wrd  BRAN
2517 L2303           .wrd  0xFFC2             ;L2272-L2303
2522 L2309           .byt  0x89,"IMMEDIAT",0xC5
2523                 .wrd  L2269             ;; link to INTERPRET
2524                 .wrd  DOCOL
2525                 .wrd  LATES
2526                 .wrd  CLIT
2527                 .byt  0x40
2528                 .wrd  TOGGL
2529                 .wrd  SEMIS
2534 L2321           .byt  0x8A,"VOCABULAR",0xD9
2535                 .wrd  L2309             ;link to IMMEDIATE
2536                 .wrd  DOCOL
2537                 .wrd  BUILD
2538                 .wrd  LIT,0xA081
2539                 .wrd  COMMA
2540                 .wrd  CURR
2541                 .wrd  AT
2542                 .wrd  CFA
2543                 .wrd  COMMA
2544                 .wrd  HERE
2545                 .wrd  VOCL
2546                 .wrd  AT
2547                 .wrd  COMMA
2548                 .wrd  VOCL
2549                 .wrd  STORE
2550                 .wrd  DOES
2551 DOVOC           .wrd  TWOP
2552                 .wrd  CON
2553                 .wrd  STORE
2554                 .wrd  SEMIS
2559 L2346           .byt  0xC5,"FORT",0xC8
2560                 .wrd  L2321             ;link to VOCABULARY
2561 FORTH           .wrd  DODOE
2562                 .wrd  DOVOC
2563                 .wrd  0xA081
2564 XFOR            .wrd  NTOP              ;points to top name in FORTH
2565 VL0             .wrd  0                 ;last vocab link ends at zero
2571 L2357           .byt  0x8B,"DEFINITION",0xD3
2572                 .wrd  L2346             ;link to FORTH
2573 DEFIN           .wrd  DOCOL
2574                 .wrd  CON
2575                 .wrd  AT
2576                 .wrd  CURR
2577                 .wrd  STORE
2578                 .wrd  SEMIS
2583 L2369           .byt  0xC1,0xA8
2584                 .wrd  L2357             ;link to DEFINITIONS
2585                 .wrd  DOCOL
2586                 .wrd  CLIT
2587                 .byt  0x29
2588                 .wrd  WORD
2589                 .wrd  SEMIS
2594 L2381           .byt  0x84,"QUI",0xD4
2595                 .wrd  L2369             ;link to (
2596 QUIT            .wrd  DOCOL
2597                 .wrd  ZERO
2598                 .wrd  BLK
2599                 .wrd  STORE
2600                 .wrd  LBRAC
2601 L2388           .wrd  RPSTO
2602                 .wrd  CR
2603                 .wrd  QUERY
2604                 .wrd  INTER
2605                 .wrd  STATE
2606                 .wrd  AT
2607                 .wrd  ZEQU
2608                 .wrd  ZBRAN
2609 L2396           .wrd  7                 ;L2399-L2396
2610                 .wrd  PDOTQ
2611                 .byt  2,"OK"
2612 L2399           .wrd  BRAN
2613 L2400           .wrd  0xFFE7             ;L2388-L2400
2614                 .wrd  SEMIS
2619 L2406           .byt  0x85,"ABOR",0xD4
2620                 .wrd  L2381             ;link to QUIT
2621 ABORT           .wrd  DOCOL
2622                 .wrd  SPSTO
2623                 .wrd  DECIM
2624                 .wrd  DR0
2625                 .wrd  CR
2626                 .wrd  PDOTQ
2627                 .byt  14,"fig-FORTH 1.0a"
2628                 .wrd  FORTH
2629                 .wrd  DEFIN
2657                 .wrd  QUIT
2662 L2423           .byt  0x84,"COL",0xC4
2663                 .wrd  L2406             ;link to ABORT
2664 COLD            .wrd  $+2
2665                 lda   ORIG+0x0C          ;from cold start area
2666                 sta   FORTH+6
2667                 lda   ORIG+0x0D
2668                 sta   FORTH+7
2669                 ldy   #0x15
2670                 bne   L2433
2671 WARM            ldy   #0x0F
2672 L2433           lda   ORIG+0x10
2673                 sta   UP
2674                 lda   ORIG+0x11
2675                 sta   UP+1
2676 L2437           lda   ORIG+0x0C,y
2677                 sta   (UP),y
2678                 dey
2679                 bpl   L2437
2680                 lda   #((ABORT+2) >> 8) & 0xFF          ;actually #>(ABORT+2)
2681                 sta   IP+1
2682                 lda   #((ABORT+2) >> 0) & 0xFF
2683                 sta   IP
2684                 cld
2685                 lda   #0x6C              ;ind jump opcode
2686                 sta   W-1
2687                 jmp   RPSTO+2           ;And off we go !
2692 L2453           .byt  0x84,"S->",0xC4
2693                 .wrd  L2423             ;link to COLD
2694 STOD            .wrd  DOCOL
2695                 .wrd  DUP
2696                 .wrd  ZLESS
2697                 .wrd  MINUS
2698                 .wrd  SEMIS
2703 L2464           .byt  0x82,"+",0xAD
2704                 .wrd  L2453             ;link to S->D
2705 PM              .wrd  DOCOL
2706                 .wrd  ZLESS
2707                 .wrd  ZBRAN
2708 L2469           .wrd  4
2709                 .wrd  MINUS
2710 L2471           .wrd  SEMIS
2715 L2476           .byt  0x83,"D+",0xAD
2716                 .wrd  L2464             ;link to +-
2717 DPM             .wrd  DOCOL
2718                 .wrd  ZLESS
2719                 .wrd  ZBRAN
2720 L2481           .wrd  4                 ;L2483-L2481
2721                 .wrd  DMINU
2722 L2483           .wrd  SEMIS
2727 L2488           .byt  0x83,"AB",0xD3
2728                 .wrd  L2476             ;link to D+-
2729 ABS             .wrd  DOCOL
2730                 .wrd  DUP
2731                 .wrd  PM
2732                 .wrd  SEMIS
2737 L2498           .byt  0x84,"DAB",0xD3
2738                 .wrd  L2488             ;link to ABS
2739 DABS            .wrd  DOCOL
2740                 .wrd  DUP
2741                 .wrd  DPM
2742                 .wrd  SEMIS
2747 L2508           .byt  0x83,"MI",0xCE
2748                 .wrd  L2498             ;link to DABS
2749 MIN             .wrd  DOCOL
2750                 .wrd  OVER
2751                 .wrd  OVER
2752                 .wrd  GREAT
2753                 .wrd  ZBRAN
2754 L2515           .wrd  4                 ;L2517-L2515
2755                 .wrd  SWAP
2756 L2517           .wrd  DROP
2757                 .wrd  SEMIS
2762 L2523           .byt  0x83,"MA",0xD8
2763                 .wrd  L2508             ;link to MIN
2764 MAX             .wrd  DOCOL
2765                 .wrd  OVER
2766                 .wrd  OVER
2767                 .wrd  LESS
2768                 .wrd  ZBRAN
2769 L2530           .wrd  4                 ;L2532-L2530
2770                 .wrd  SWAP
2771 L2532           .wrd  DROP
2772                 .wrd  SEMIS
2777 L2538           .byt  0x82,"M",0xAA
2778                 .wrd  L2523             ;link to MAX
2779 MSTAR           .wrd  DOCOL
2780                 .wrd  OVER
2781                 .wrd  OVER
2782                 .wrd  XOR
2783                 .wrd  TOR
2784                 .wrd  ABS
2785                 .wrd  SWAP
2786                 .wrd  ABS
2787                 .wrd  USTAR
2788                 .wrd  RFROM
2789                 .wrd  DPM
2790                 .wrd  SEMIS
2795 L2556           .byt  0x82,"M",0xAF
2796                 .wrd  L2538             ;link to M*
2797 MSLAS           .wrd  DOCOL
2798                 .wrd  OVER
2799                 .wrd  TOR
2800                 .wrd  TOR
2801                 .wrd  DABS
2802                 .wrd  R
2803                 .wrd  ABS
2804                 .wrd  USLAS
2805                 .wrd  RFROM
2806                 .wrd  R
2807                 .wrd  XOR
2808                 .wrd  PM
2809                 .wrd  SWAP
2810                 .wrd  RFROM
2811                 .wrd  PM
2812                 .wrd  SWAP
2813                 .wrd  SEMIS
2818 L2579           .byt  0x81,0xAA
2819                 .wrd  L2556             ;link to M/
2820 STAR            .wrd  DOCOL
2821                 .wrd  USTAR
2822                 .wrd  DROP
2823                 .wrd  SEMIS
2828 L2589           .byt  0x84,"/MO",0xC4
2829                 .wrd  L2579             ;link to *
2830 SLMOD           .wrd  DOCOL
2831                 .wrd  TOR
2832                 .wrd  STOD
2833                 .wrd  RFROM
2834                 .wrd  MSLAS
2835                 .wrd  SEMIS
2840 L2601           .byt  0x81,0xAF
2841                 .wrd  L2589             ;link to /MOD
2842 SLASH           .wrd  DOCOL
2843                 .wrd  SLMOD
2844                 .wrd  SWAP
2845                 .wrd  DROP
2846                 .wrd  SEMIS
2851 L2612           .byt  0x83,"MO",0xC4
2852                 .wrd  L2601             ;link to /
2853 MOD             .wrd  DOCOL
2854                 .wrd  SLMOD
2855                 .wrd  DROP
2856                 .wrd  SEMIS
2861 L2622           .byt  0x85,"*/MO",0xC4
2862                 .wrd  L2612             ;link to MOD
2863 SSMOD           .wrd  DOCOL
2864                 .wrd  TOR
2865                 .wrd  MSTAR
2866                 .wrd  RFROM
2867                 .wrd  MSLAS
2868                 .wrd  SEMIS
2873 L2634           .byt  0x82,"*",0xAF
2874                 .wrd  L2622             ;link to */MOD
2875 SSLAS           .wrd  DOCOL
2876                 .wrd  SSMOD
2877                 .wrd  SWAP
2878                 .wrd  DROP
2879                 .wrd  SEMIS
2884 L2645           .byt  0x85,"M/MO",0xC4
2885                 .wrd  L2634             ;link to */
2886 MSMOD           .wrd  DOCOL
2887                 .wrd  TOR
2888                 .wrd  ZERO
2889                 .wrd  R
2890                 .wrd  USLAS
2891                 .wrd  RFROM
2892                 .wrd  SWAP
2893                 .wrd  TOR
2894                 .wrd  USLAS
2895                 .wrd  RFROM
2896                 .wrd  SEMIS
2901 L2662           .byt  0x83,"US",0xC5
2902                 .wrd  L2645             ;link to M/MOD
2903 USE             .wrd  DOVAR
2904                 .wrd  DAREA
2909 L2670           .byt  0x84,"PRE",0xD6
2910                 .wrd  L2662             ;link to USE
2911 PREV            .wrd  DOVAR
2912                 .wrd  DAREA
2918 L2678           .byt  0x84,"+BU",0xC6
2919                 .wrd  L2670             ;link to PREV
2920 PBUF            .wrd  DOCOL
2921                 .wrd  LIT
2922                 .wrd  SSIZE+4           ;hold block #, one sector two num
2923                 .wrd  PLUS
2924                 .wrd  DUP
2925                 .wrd  LIMIT
2926                 .wrd  EQUAL
2927                 .wrd  ZBRAN
2928 L2688           .wrd  6                 ;L2691-L2688
2929                 .wrd  DROP
2930                 .wrd  FIRST
2931 L2691           .wrd  DUP
2932                 .wrd  PREV
2933                 .wrd  AT
2934                 .wrd  SUB
2935                 .wrd  SEMIS
2940 L2700           .byt  0x86,"UPDAT",0xC5
2941                 .wrd  L2678             ;link to +BUF
2942 UPDAT           .wrd  DOCOL
2943                 .wrd  PREV
2944                 .wrd  AT
2945                 .wrd  AT
2946                 .wrd  LIT,0x8000
2947                 .wrd  OR
2948                 .wrd  PREV
2949                 .wrd  AT
2950                 .wrd  STORE
2951                 .wrd  SEMIS
2955 L2705           .byt  0x85,"FLUS",0xC8
2956                 .wrd  L2700             ;link to UPDATE
2957                 .wrd  DOCOL
2958                 .wrd  LIMIT,FIRST,SUB
2959                 .wrd  BBUF,CLIT
2960                 .byt  4
2961                 .wrd  PLUS,SLASH,ONEP
2962                 .wrd  ZERO,PDO
2963 L2835           .wrd  LIT,0x7FFF,BUFFR
2964                 .wrd  DROP,PLOOP
2965 L2839           .wrd  0xFFF6             ;L2835-L2839
2966                 .wrd  SEMIS
2971 L2716           .byt  0x8D,"EMPTY-BUFFER",0xD3
2972                 .wrd  L2705             ;link to FLUSH
2973                 .wrd  DOCOL
2974                 .wrd  FIRST
2975                 .wrd  LIMIT
2976                 .wrd  OVER
2977                 .wrd  SUB
2978                 .wrd  ERASE
2979                 .wrd  SEMIS
2984 L2729           .byt  0x83,"DR",0xB0
2985                 .wrd  L2716             ;link to EMPTY-BUFFERS
2986 DR0             .wrd  DOCOL
2987                 .wrd  ZERO
2988                 .wrd  OFSET
2989                 .wrd  STORE
2990                 .wrd  SEMIS
2995 L2740           .byt  0x83,"DR",0xB1
2996                 .wrd  L2729             ;link to DR0
2997                 .wrd  DOCOL
2998                 .wrd  LIT,SECTR         ;sectors per drive
2999                 .wrd  OFSET
3000                 .wrd  STORE
3001                 .wrd  SEMIS
3006 L2751           .byt  0x86,"BUFFE",0xD2
3007                 .wrd  L2740             ;link to DR1
3008 BUFFR           .wrd  DOCOL
3009                 .wrd  USE
3010                 .wrd  AT
3011                 .wrd  DUP
3012                 .wrd  TOR
3013 L2758           .wrd  PBUF
3014                 .wrd  ZBRAN
3015 L2760           .wrd  0xFFFC             ;L2758-L2760
3016                 .wrd  USE
3017                 .wrd  STORE
3018                 .wrd  R
3019                 .wrd  AT
3020                 .wrd  ZLESS
3021                 .wrd  ZBRAN
3022 L2767           .wrd  0x14               ;L2776-L2767
3023                 .wrd  R
3024                 .wrd  TWOP
3025                 .wrd  R
3026                 .wrd  AT
3027                 .wrd  LIT,0x7FFF
3028                 .wrd  ANDD
3029                 .wrd  ZERO
3031                 .wrd  RSW
3032 L2776           .wrd  R
3033                 .wrd  STORE
3034                 .wrd  R
3035                 .wrd  PREV
3036                 .wrd  STORE
3037                 .wrd  RFROM
3038                 .wrd  TWOP
3039                 .wrd  SEMIS
3044 L2788           .byt  0x85,"BLOC",0xCB
3045                 .wrd  L2751             ;link to BUFFER
3046 BLOCK           .wrd  DOCOL
3047                 .wrd  OFSET
3048                 .wrd  AT
3049                 .wrd  PLUS
3050                 .wrd  TOR
3051                 .wrd  PREV
3052                 .wrd  AT
3053                 .wrd  DUP
3054                 .wrd  AT
3055                 .wrd  R
3056                 .wrd  SUB
3057                 .wrd  DUP
3058                 .wrd  PLUS
3059                 .wrd  ZBRAN
3060 L2804           .wrd  0x34               ;L2830-L2804
3061 L2805           .wrd  PBUF
3062                 .wrd  ZEQU
3063                 .wrd  ZBRAN
3064 L2808           .wrd  0x14               ;L2818-L2808
3065                 .wrd  DROP
3066                 .wrd  R
3067                 .wrd  BUFFR
3068                 .wrd  DUP
3069                 .wrd  R
3070                 .wrd  ONE
3072                 .wrd  RSW
3073                 .wrd  TWO
3074                 .wrd  SUB
3075 L2818           .wrd  DUP
3076                 .wrd  AT
3077                 .wrd  R
3078                 .wrd  SUB
3079                 .wrd  DUP
3080                 .wrd  PLUS
3081                 .wrd  ZEQU
3082                 .wrd  ZBRAN
3083 L2826           .wrd  0xFFD6             ;L2805-L2826
3084                 .wrd  DUP
3085                 .wrd  PREV
3086                 .wrd  STORE
3087 L2830           .wrd  RFROM
3088                 .wrd  DROP
3089                 .wrd  TWOP
3090                 .wrd  SEMIS             ;end of BLOCK
3096 L2838           .byt  0x86,"(LINE",0xA9
3097                 .wrd  L2788             ;link to BLOCK
3098 PLINE           .wrd  DOCOL
3099                 .wrd  TOR
3100                 .wrd  CSLL
3101                 .wrd  BBUF
3102                 .wrd  SSMOD
3103                 .wrd  RFROM
3104                 .wrd  BSCR
3105                 .wrd  STAR
3106                 .wrd  PLUS
3107                 .wrd  BLOCK
3108                 .wrd  PLUS
3109                 .wrd  CSLL
3110                 .wrd  SEMIS
3115 L2857           .byt  0x85,".LIN",0xC5
3116                 .wrd  L2838             ;link to (LINE)
3117 DLINE           .wrd  DOCOL
3118                 .wrd  PLINE
3119                 .wrd  DTRAI
3120                 .wrd  TYPE
3121                 .wrd  SEMIS
3126 L2868           .byt  0x87,"MESSAG",0xC5
3127                 .wrd  L2857             ;link to .LINE
3128 MESS            .wrd  DOCOL
3129                 .wrd  WARN
3130                 .wrd  AT
3131                 .wrd  ZBRAN
3132 L2874           .wrd  0x1B               ;L2888-L2874
3133                 .wrd  DDUP
3134                 .wrd  ZBRAN
3135 L2877           .wrd  0x11               ;L2886-L2877
3136                 .wrd  CLIT
3137                 .byt  4
3138                 .wrd  OFSET
3139                 .wrd  AT
3140                 .wrd  BSCR
3141                 .wrd  SLASH
3142                 .wrd  SUB
3143                 .wrd  DLINE
3144 L2886           .wrd  BRAN
3145 L2887           .wrd  13                ;L2891-L2887
3146 L2888           .wrd  PDOTQ
3147                 .byt  6,"MSG # "
3148                 .wrd  DOT
3149 L2891           .wrd  SEMIS
3154 L2896           .byt  0x84,"LOA",0xC4
3155                 .wrd  L2868             ;link to MESSAGE
3156 LOAD            .wrd  DOCOL
3157                 .wrd  BLK
3158                 .wrd  AT
3159                 .wrd  TOR
3160                 .wrd  IN
3161                 .wrd  AT
3162                 .wrd  TOR
3163                 .wrd  ZERO
3164                 .wrd  IN
3165                 .wrd  STORE
3166                 .wrd  BSCR
3167                 .wrd  STAR
3168                 .wrd  BLK
3169                 .wrd  STORE
3170                 .wrd  INTER
3171                 .wrd  RFROM
3172                 .wrd  IN
3173                 .wrd  STORE
3174                 .wrd  RFROM
3175                 .wrd  BLK
3176                 .wrd  STORE
3177                 .wrd  SEMIS
3182 L2924           .byt  0xC3,"--",0xBE
3183                 .wrd  L2896             ;link to LOAD
3184                 .wrd  DOCOL
3185                 .wrd  QLOAD
3186                 .wrd  ZERO
3187                 .wrd  IN
3188                 .wrd  STORE
3189                 .wrd  BSCR
3190                 .wrd  BLK
3191                 .wrd  AT
3192                 .wrd  OVER
3193                 .wrd  MOD
3194                 .wrd  SUB
3195                 .wrd  BLK
3196                 .wrd  PSTOR
3197                 .wrd  SEMIS
3212 XEMIT           lda     0,x         ; fetch character to output
3214                 and     #0x7F
3215                 jsr     cout        ; and display it
3217                  jmp    POP
3224 XKEY            jsr     cin         ; might otherwise clobber it while
3226                 jmp     PUSHOA
3233 XQTER           clc
3234                 lda     #0x00        ; 0
3235                 rol     a           ; move carry to bit 0
3236                 jmp     PUSHOA
3243 XCR             jsr     crout               ;use monitor call
3245                 jmp     NEXT
3277 L3050           .byt  0x84,"-BC",0xC4
3278                 .wrd  L2924             ;link to -DISC
3279 DBCD            .wrd  DOCOL
3280                 .wrd  ZERO,CLIT
3281                 .byt  10
3282                 .wrd  USLAS,CLIT
3283                 .byt  16
3284                 .wrd  STAR,OR,SEMIS
3312 L3070           .byt  0x83,"RS",0xD7
3313                 .wrd  L3050             ;link to R/W
3314 RSW             .wrd  DOCOL
3315                 .wrd  TOR
3316                 .wrd  BBUF, STAR, LIT, 0x4000, PLUS, DUP
3317                 .wrd  LIT, 0x6800, GREAT, LIT, 0x6, QERR
3318                 .wrd  RFROM, ZBRAN, 0x4, SWAP
3319                 .wrd  BBUF, CMOVE
3320                 .wrd  SEMIS
3326 L3202           .byt  0xC1,0xA7
3327                 .wrd  L3070             ;link to RSW
3328 TICK            .wrd  DOCOL
3329                 .wrd  DFIND
3330                 .wrd  ZEQU
3331                 .wrd  ZERO
3332                 .wrd  QERR
3333                 .wrd  DROP
3334                 .wrd  LITER
3335                 .wrd  SEMIS
3341 L3217           .byt  0x86,"FORGE",0xD4
3342                 .wrd  L3202             ;link to ' TICK
3343 FORG            .wrd  DOCOL
3344                 .wrd  TICK,NFA,DUP
3345                 .wrd  FENCE,AT,ULESS,CLIT
3346                 .byt  0x15
3347                 .wrd  QERR,TOR,VOCL,AT
3348 L3220           .wrd  R,OVER,ULESS
3349                 .wrd  ZBRAN,L3225-$
3350                 .wrd  FORTH,DEFIN,AT,DUP
3351                 .wrd  VOCL,STORE
3352                 .wrd  BRAN,0xFFFF-24+1   ;L3220-$
3353 L3225           .wrd  DUP,CLIT
3354                 .byt  4
3355                 .wrd  SUB
3356 L3228           .wrd  PFA,LFA,AT
3357                 .wrd  DUP,R,ULESS
3358                 .wrd  ZBRAN,0xFFFF-14+1  ;L3228-$
3359                 .wrd  OVER,TWO,SUB,STORE
3360                 .wrd  AT,DDUP,ZEQU
3361                 .wrd  ZBRAN,0xFFFF-39+1  ;L3225-$
3362                 .wrd  RFROM,DP,STORE
3363                 .wrd  SEMIS
3368 L3250           .byt  0x84,"BAC",0xCB
3369                 .wrd  L3217             ;link to FORGET
3370 BACK            .wrd  DOCOL
3371                 .wrd  HERE
3372                 .wrd  SUB
3373                 .wrd  COMMA
3374                 .wrd  SEMIS
3379 L3261           .byt  0xC5,"BEGI",0xCE
3380                 .wrd  L3250             ;link to BACK
3381                 .wrd  DOCOL
3382                 .wrd  QCOMP
3383                 .wrd  HERE
3384                 .wrd  ONE
3385                 .wrd  SEMIS
3390 L3273           .byt  0xC5,"ENDI",0xC6
3391                 .wrd  L3261             ;link to BEGIN
3392 ENDIF           .wrd  DOCOL
3393                 .wrd  QCOMP
3394                 .wrd  TWO
3395                 .wrd  QPAIR
3396                 .wrd  HERE
3397                 .wrd  OVER
3398                 .wrd  SUB
3399                 .wrd  SWAP
3400                 .wrd  STORE
3401                 .wrd  SEMIS
3406 L3290           .byt  0xC4,"THE",0xCE
3407                 .wrd  L3273             ;link to ENDIF
3408                 .wrd  DOCOL
3409                 .wrd  ENDIF
3410                 .wrd  SEMIS
3415 L3300           .byt  0xC2,"D",0xCF
3416                 .wrd  L3290             ;link to THEN
3417                 .wrd  DOCOL
3418                 .wrd  COMP
3419                 .wrd  PDO
3420                 .wrd  HERE
3421                 .wrd  THREE
3422                 .wrd  SEMIS
3428 L3313           .byt  0xC4,"LOO",0xD0
3429                 .wrd  L3300             ;link to DO
3430                 .wrd  DOCOL
3431                 .wrd  THREE
3432                 .wrd  QPAIR
3433                 .wrd  COMP
3434                 .wrd  PLOOP
3435                 .wrd  BACK
3436                 .wrd  SEMIS
3441 L3327           .byt  0xC5,"+LOO",0xD0
3442                 .wrd  L3313             ;link to LOOP
3443                 .wrd  DOCOL
3444                 .wrd  THREE
3445                 .wrd  QPAIR
3446                 .wrd  COMP
3447                 .wrd  PPLOO
3448                 .wrd  BACK
3449                 .wrd  SEMIS
3454 L3341           .byt  0xC5,"UNTI",0xCC
3455                 .wrd  L3327             ;link to +LOOP
3456 UNTIL           .wrd  DOCOL
3457                 .wrd  ONE
3458                 .wrd  QPAIR
3459                 .wrd  COMP
3460                 .wrd  ZBRAN
3461                 .wrd  BACK
3462                 .wrd  SEMIS
3467 L3355           .byt  0xC3,"EN",0xC4
3468                 .wrd  L3341             ;link to UNTIL
3469                 .wrd  DOCOL
3470                 .wrd  UNTIL
3471                 .wrd  SEMIS
3476 L3365           .byt  0xC5,"AGAI",0xCE
3477                 .wrd  L3355             ;link to END
3478 AGAIN           .wrd  DOCOL
3479                 .wrd  ONE
3480                 .wrd  QPAIR
3481                 .wrd  COMP
3482                 .wrd  BRAN
3483                 .wrd  BACK
3484                 .wrd  SEMIS
3489 L3379           .byt  0xC6,"REPEA",0xD4
3490                 .wrd  L3365             ;link to AGAIN
3491                 .wrd  DOCOL
3492                 .wrd  TOR
3493                 .wrd  TOR
3494                 .wrd  AGAIN
3495                 .wrd  RFROM
3496                 .wrd  RFROM
3497                 .wrd  TWO
3498                 .wrd  SUB
3499                 .wrd  ENDIF
3500                 .wrd  SEMIS
3505 L3396           .byt  0xC2,"I",0xC6
3506                 .wrd  L3379             ;link to REPEAT
3507 IF              .wrd  DOCOL
3508                 .wrd  COMP
3509                 .wrd  ZBRAN
3510                 .wrd  HERE
3511                 .wrd  ZERO
3512                 .wrd  COMMA
3513                 .wrd  TWO
3514                 .wrd  SEMIS
3519 L3411           .byt  0xC4,"ELS",0xC5
3520                 .wrd  L3396             ;link to IF
3521                 .wrd  DOCOL
3522                 .wrd  TWO
3523                 .wrd  QPAIR
3524                 .wrd  COMP
3525                 .wrd  BRAN
3526                 .wrd  HERE
3527                 .wrd  ZERO
3528                 .wrd  COMMA
3529                 .wrd  SWAP
3530                 .wrd  TWO
3531                 .wrd  ENDIF
3532                 .wrd  TWO
3533                 .wrd  SEMIS
3538 L3431           .byt  0xC5,"WHIL",0xC5
3539                 .wrd  L3411             ;link to ELSE
3540                 .wrd  DOCOL
3541                 .wrd  IF
3542                 .wrd  TWOP
3543                 .wrd  SEMIS
3548 L3442           .byt  0x86,"SPACE",0xD3
3549                 .wrd  L3431             ;link to WHILE
3550 SPACS           .wrd  DOCOL
3551                 .wrd  ZERO
3552                 .wrd  MAX
3553                 .wrd  DDUP
3554                 .wrd  ZBRAN
3555 L3449           .wrd  0x0C               ;L3455-L3449
3556                 .wrd  ZERO
3557                 .wrd  PDO
3558 L3452           .wrd  SPACE
3559                 .wrd  PLOOP
3560 L3454           .wrd  0xFFFC             ;L3452-L3454
3561 L3455           .wrd  SEMIS
3566 L3460           .byt  0x82,"<",0xA3
3567                 .wrd  L3442             ;link to SPACES
3568 BDIGS           .wrd  DOCOL
3569                 .wrd  PAD
3570                 .wrd  HLD
3571                 .wrd  STORE
3572                 .wrd  SEMIS
3577 L3471           .byt  0x82,"#",0xBE
3578                 .wrd  L3460             ;link to <#
3579 EDIGS           .wrd  DOCOL
3580                 .wrd  DROP
3581                 .wrd  DROP
3582                 .wrd  HLD
3583                 .wrd  AT
3584                 .wrd  PAD
3585                 .wrd  OVER
3586                 .wrd  SUB
3587                 .wrd  SEMIS
3592 L3486           .byt  0x84,"SIG",0xCE
3593                 .wrd  L3471             ;link to #>
3594 SIGN            .wrd  DOCOL
3595                 .wrd  ROT
3596                 .wrd  ZLESS
3597                 .wrd  ZBRAN
3598 L3492           .wrd  0x7                ;L3496-L3492
3599                 .wrd  CLIT
3600                 .byt  0x2D
3601                 .wrd  HOLD
3602 L3496           .wrd  SEMIS
3607 L3501           .byt  0x81,0xA3
3608                 .wrd  L3486             ;link to SIGN
3609 DIG             .wrd  DOCOL
3610                 .wrd  BASE
3611                 .wrd  AT
3612                 .wrd  MSMOD
3613                 .wrd  ROT
3614                 .wrd  CLIT
3615                 .byt  9
3616                 .wrd  OVER
3617                 .wrd  LESS
3618                 .wrd  ZBRAN
3619 L3513           .wrd  7                 ;L3517-L3513
3620                 .wrd  CLIT
3621                 .byt  7
3622                 .wrd  PLUS
3623 L3517           .wrd  CLIT
3624                 .byt  0x30
3625                 .wrd  PLUS
3626                 .wrd  HOLD
3627                 .wrd  SEMIS
3632 L3526           .byt  0x82,"#",0xD3
3633                 .wrd  L3501             ;link to #
3634 DIGS            .wrd  DOCOL
3635 L3529           .wrd  DIG
3636                 .wrd  OVER
3637                 .wrd  OVER
3638                 .wrd  OR
3639                 .wrd  ZEQU
3640                 .wrd  ZBRAN
3641 L3535           .wrd  0xFFF4             ;L3529-L3535
3642                 .wrd  SEMIS
3647 L3541           .byt  0x83,"D.",0xD2
3648                 .wrd  L3526             ;link to #S
3649 DDOTR           .wrd  DOCOL
3650                 .wrd  TOR
3651                 .wrd  SWAP
3652                 .wrd  OVER
3653                 .wrd  DABS
3654                 .wrd  BDIGS
3655                 .wrd  DIGS
3656                 .wrd  SIGN
3657                 .wrd  EDIGS
3658                 .wrd  RFROM
3659                 .wrd  OVER
3660                 .wrd  SUB
3661                 .wrd  SPACS
3662                 .wrd  TYPE
3663                 .wrd  SEMIS
3668 L3562           .byt  0x82,"D",0xAE
3669                 .wrd  L3541             ;link to D.R
3670 DDOT            .wrd  DOCOL
3671                 .wrd  ZERO
3672                 .wrd  DDOTR
3673                 .wrd  SPACE
3674                 .wrd  SEMIS
3679 L3573           .byt  0x82,".",0xD2
3680                 .wrd  L3562             ;link to D.
3681 DOTR            .wrd  DOCOL
3682                 .wrd  TOR
3683                 .wrd  STOD
3684                 .wrd  RFROM
3685                 .wrd  DDOTR
3686                 .wrd  SEMIS
3691 L3585           .byt  0x81,0xAE
3692                 .wrd  L3573             ;link to .R
3693 DOT             .wrd  DOCOL
3694                 .wrd  STOD
3695                 .wrd  DDOT
3696                 .wrd  SEMIS
3701 L3595           .byt  0x81,0xBF
3702                 .wrd  L3585             ;link to .
3703 QUES            .wrd  DOCOL
3704                 .wrd  AT
3705                 .wrd  DOT
3706                 .wrd  SEMIS
3711 L3605           .byt  0x84,"LIS",0xD4
3712                 .wrd  L3595             ;link to ?
3713 LIST            .wrd  DOCOL
3714                 .wrd  DECIM
3715                 .wrd  CR
3716                 .wrd  DUP
3717                 .wrd  SCR
3718                 .wrd  STORE
3719                 .wrd  PDOTQ
3720                 .byt  6,"SCR # "
3721                 .wrd  DOT
3722                 .wrd  CLIT
3723                 .byt  16
3724                 .wrd  ZERO
3725                 .wrd  PDO
3726 L3620           .wrd  CR
3727                 .wrd  I
3728                 .wrd  THREE
3729                 .wrd  DOTR
3730                 .wrd  SPACE
3731                 .wrd  I
3732                 .wrd  SCR
3733                 .wrd  AT
3734                 .wrd  DLINE
3735                 .wrd  PLOOP
3736 L3630           .wrd  0xFFEC
3737                 .wrd  CR
3738                 .wrd  SEMIS
3743 L3637           .byt  0x85,"INDE",0xD8
3744                 .wrd  L3605             ;link to LIST
3745                 .wrd  DOCOL
3746                 .wrd  CR
3747                 .wrd  ONEP
3748                 .wrd  SWAP
3749                 .wrd  PDO
3750 L3647           .wrd  CR
3751                 .wrd  I
3752                 .wrd  THREE
3753                 .wrd  DOTR
3754                 .wrd  SPACE
3755                 .wrd  ZERO
3756                 .wrd  I
3757                 .wrd  DLINE
3758                 .wrd  QTERM
3759                 .wrd  ZBRAN
3760 L3657           .wrd  4                 ;L3659-L3657
3761                 .wrd  LEAVE
3762 L3659           .wrd  PLOOP
3763 L3660           .wrd  0xFFE6             ;L3647-L3660
3764                 .wrd  CLIT
3765                 .byt  0x0C               ;form feed for printer
3766                 .wrd  EMIT
3767                 .wrd  SEMIS
3772 L3666           .byt  0x85,"TRIA",0xC4
3773                 .wrd  L3637             ;link to INDEX
3774                 .wrd  DOCOL
3775                 .wrd  THREE
3776                 .wrd  SLASH
3777                 .wrd  THREE
3778                 .wrd  STAR
3779                 .wrd  THREE
3780                 .wrd  OVER
3781                 .wrd  PLUS
3782                 .wrd  SWAP
3783                 .wrd  PDO
3784 L3681           .wrd  CR
3785                 .wrd  I
3786                 .wrd  LIST
3787                 .wrd  PLOOP
3788 L3685           .wrd  0xFFF8             ;L3681-L3685
3789                 .wrd  CR
3790                 .wrd  CLIT
3791                 .byt  0xF
3792                 .wrd  MESS
3793                 .wrd  CR
3794                 .wrd  CLIT
3795                 .byt  0x0C               ;form feed for printer
3796                 .wrd  EMIT
3797                 .wrd  SEMIS
3803 L3696           .byt  0x85,"VLIS",0xD4
3804                 .wrd  L3666             ;link to TRIAD
3805 VLIST           .wrd  DOCOL
3806                 .wrd  CLIT
3807                 .byt  0x80
3808                 .wrd  OUT
3809                 .wrd  STORE
3810                 .wrd  CON
3811                 .wrd  AT
3812                 .wrd  AT
3813 L3706           .wrd  OUT
3814                 .wrd  AT
3815                 .wrd  CSLL
3816                 .wrd  GREAT
3817                 .wrd  ZBRAN
3818 L3711           .wrd  0xA                ;L3716-L3711
3819                 .wrd  CR
3820                 .wrd  ZERO
3821                 .wrd  OUT
3822                 .wrd  STORE
3823 L3716           .wrd  DUP
3824                 .wrd  IDDOT
3825                 .wrd  SPACE
3826                 .wrd  SPACE
3827                 .wrd  PFA
3828                 .wrd  LFA
3829                 .wrd  AT
3830                 .wrd  DUP
3831                 .wrd  ZEQU
3832                 .wrd  QTERM
3833                 .wrd  OR
3834                 .wrd  ZBRAN
3835 L3728           .wrd  0xFFD4             ;L3706-L3728
3836                 .wrd  DROP
3837                 .wrd  SEMIS
3842 NTOP            .byt    0x83,"MO",0xCE
3843                 .wrd    L3696             ;link to VLIST
3844 MON             .wrd    $+2
3845                 brk
3847                 jmp     NEXT
3853 TOP             .equ    $                ;end of listing
