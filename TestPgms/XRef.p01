   1    2 	.stk 1024
   2    3 	.cod 512
   3    4 STATIC_LINK			.equ +5
   4    5 RETURN_VALUE		.equ -3
   5    6 HIGH_RETURN_VALUE	.equ -1
   6    7 _start
   7    8 	tsx.w
   8    9 	lds.w #16383
   9   10 	jmp _pc65_main
  10   30 word_002	.equ +0
  11   34 firstnumberindex_003	.equ +20
  12   35 lastnumberindex_004	.equ +22
  13   41 number_005	.equ +0
  14   44 nextindex_006	.equ +2
  15   72 ch_017	.equ -5
  16   73 nextchar_016	.sub
  17   74 	phx.w
  18   75 	tsx.w
  19   76 	adj #-4
  20   77 	adj #-2
  21   79 	jsr _eol
  22   80 	sta.w newline_014
  23   82 	lda.w newline_014
  24   83 	cmp.w #1
  25   84 	beq L_018
  26   85 	jmp  L_019
  27   86 L_018
  28   88 	jsr _readln
  29   90 	jsr _writeln
  30   92 	lda.w linenumber_011
  31   93 	pha.w
  32   94 	lda #1
  33   95 	clc
  34   96 	adc.w 1,S
  35   97 	adj #2
  36   98 	sta.w linenumber_011
  37  100 	lda.w linenumber_011
  38  101 	pha.w
  39  102 	lda #5
  40  103 	pha.w
  41  104 	jsr _iwrite
  42  105 	adj #4
  43  106 	psh.w #S_020
  44  107 	psh.w #0
  45  108 	psh.w #3
  46  109 	jsr _swrite
  47  110 	adj #6
  48  112 L_019
  49  114 	lda.w newline_014
  50  115 	pha.w
  51  116 	jsr _eof
  52  117 	ora.w 1,S
  53  118 	adj #2
  54  119 	cmp.w #1
  55  120 	beq L_021
  56  121 	jmp  L_022
  57  122 L_021
  58  124 	lda #32
  59  125 	sta ch_017
  60  128 	jmp L_023
  61  129 L_022
  62  131 	txa.w
  63  132 	clc
  64  133 	adc.w #ch_017
  65  134 	pha.w
  66  135 	jsr _cread
  67  136 	pli
  68  137 	sta 0,I++
  69  139 	lda ch_017,X
  70  140 	pha.w
  71  141 	psh.w #0
  72  142 	jsr _cwrite
  73  143 	adj #4
  74  145 L_023
  75  147 	lda ch_017,X
  76  148 	tay
  77  149 	tya
  78  150 	sta.w RETURN_VALUE,X
  79  152 	lda.w RETURN_VALUE,X
  80  153 	txs.w
  81  154 	plx.w
  82  155 	rts
  83  156 	.end nextchar_016
  84  164 ch_025	.equ +7
  85  165 isletter_024	.sub
  86  166 	phx.w
  87  167 	tsx.w
  88  168 	adj #-4
  89  170 	lda ch_025,X
  90  171 	pha.w
  91  172 	lda #97
  92  173 	xma.w 1,S
  93  174 	cmp.w 1,S
  94  175 	adj #2
  95  176 	php
  96  177 	lda #1
  97  178 	plp
  98  179 	bge L_026
  99  180 	lda #0
 100  181 L_026
 101  182 	pha.w
 102  183 	lda ch_025,X
 103  184 	pha.w
 104  185 	lda #122
 105  186 	xma.w 1,S
 106  187 	cmp.w 1,S
 107  188 	adj #2
 108  189 	php
 109  190 	lda #1
 110  191 	plp
 111  192 	ble L_027
 112  193 	lda #0
 113  194 L_027
 114  195 	and.w 1,S
 115  196 	adj #2
 116  198 	pha.w
 117  199 	lda ch_025,X
 118  200 	pha.w
 119  201 	lda #65
 120  202 	xma.w 1,S
 121  203 	cmp.w 1,S
 122  204 	adj #2
 123  205 	php
 124  206 	lda #1
 125  207 	plp
 126  208 	bge L_028
 127  209 	lda #0
 128  210 L_028
 129  211 	pha.w
 130  212 	lda ch_025,X
 131  213 	pha.w
 132  214 	lda #90
 133  215 	xma.w 1,S
 134  216 	cmp.w 1,S
 135  217 	adj #2
 136  218 	php
 137  219 	lda #1
 138  220 	plp
 139  221 	ble L_029
 140  222 	lda #0
 141  223 L_029
 142  224 	and.w 1,S
 143  225 	adj #2
 144  226 	ora.w 1,S
 145  227 	adj #2
 146  228 	sta.w RETURN_VALUE,X
 147  230 	lda.w RETURN_VALUE,X
 148  231 	txs.w
 149  232 	plx.w
 150  233 	rts
 151  234 	.end isletter_024
 152  249 buffer_031	.equ +7
 153  250 charcount_032	.equ -1
 154  251 ch_033	.equ -3
 155  252 readword_030	.sub
 156  253 	phx.w
 157  254 	tsx.w
 158  255 	adj #-4
 159  257 	lda #0
 160  258 	sta.w gotword_015
 161  262 	jsr _eof
 162  263 	eor #1
 163  264 	cmp.w #1
 164  265 	beq L_034
 165  266 	jmp  L_035
 166  267 L_034
 167  269 L_036
 168  271 	lda.w STATIC_LINK,X
 169  272 	pha.w
 170  273 	jsr nextchar_016
 171  274 	adj #2
 172  275 	sta ch_033
 173  277 	jsr _eof
 174  278 	pha.w
 175  279 	lda ch_033,X
 176  280 	pha.w
 177  281 	lda.w STATIC_LINK,X
 178  282 	pha.w
 179  283 	jsr isletter_024
 180  284 	adj #4
 181  285 	ora.w 1,S
 182  286 	adj #2
 183  287 	cmp.w #1
 184  288 	beq L_037
 185  289 	jmp L_036
 186  290 L_037
 187  292 L_035
 188  296 	jsr _eof
 189  297 	eor #1
 190  298 	cmp.w #1
 191  299 	beq L_038
 192  300 	jmp  L_039
 193  301 L_038
 194  303 	lda #0
 195  304 	sta.w charcount_032,X
 196  309 L_040
 197  310 	lda ch_033,X
 198  311 	pha.w
 199  312 	lda.w STATIC_LINK,X
 200  313 	pha.w
 201  314 	jsr isletter_024
 202  315 	adj #4
 203  316 	cmp.w #1
 204  317 	beq L_041
 205  318 	jmp L_042
 206  319 L_041
 207  321 	lda.w charcount_032,X
 208  322 	pha.w
 209  323 	lda #20
 210  324 	xma.w 1,S
 211  325 	cmp.w 1,S
 212  326 	adj #2
 213  327 	php
 214  328 	lda #1
 215  329 	plp
 216  330 	blt L_045
 217  331 	lda #0
 218  332 L_045
 219  333 	cmp.w #1
 220  334 	beq L_043
 221  335 	jmp  L_044
 222  336 L_043
 223  338 	lda ch_033,X
 224  339 	pha.w
 225  340 	lda #65
 226  341 	xma.w 1,S
 227  342 	cmp.w 1,S
 228  343 	adj #2
 229  344 	php
 230  345 	lda #1
 231  346 	plp
 232  347 	bge L_048
 233  348 	lda #0
 234  349 L_048
 235  350 	pha.w
 236  351 	lda ch_033,X
 237  352 	pha.w
 238  353 	lda #90
 239  354 	xma.w 1,S
 240  355 	cmp.w 1,S
 241  356 	adj #2
 242  357 	php
 243  358 	lda #1
 244  359 	plp
 245  360 	ble L_049
 246  361 	lda #0
 247  362 L_049
 248  363 	and.w 1,S
 249  364 	adj #2
 250  365 	cmp.w #1
 251  366 	beq L_046
 252  367 	jmp  L_047
 253  368 L_046
 254  370 	lda ch_033,X
 255  371 	pha.w
 256  372 	lda #97
 257  373 	pha.w
 258  374 	lda #65
 259  375 	xma.w 1,S
 260  376 	sec
 261  377 	sbc.w 1,S
 262  378 	adj #2
 263  379 	clc
 264  380 	adc.w 1,S
 265  381 	adj #2
 266  382 	sta ch_033
 267  384 L_047
 268  386 	lda.w charcount_032,X
 269  387 	pha.w
 270  388 	lda #1
 271  389 	clc
 272  390 	adc.w 1,S
 273  391 	adj #2
 274  392 	sta.w charcount_032,X
 275  394 	lda.w buffer_031,X
 276  395 	pha.w
 277  396 	lda.w charcount_032,X
 278  397 	dec.w a
 279  398 	clc
 280  399 	adc.w 1,S
 281  400 	sta.w 1,S
 282  401 	lda ch_033,X
 283  402 	pli
 284  403 	sta 0,I++
 285  405 L_044
 286  407 	lda.w STATIC_LINK,X
 287  408 	pha.w
 288  409 	jsr nextchar_016
 289  410 	adj #2
 290  411 	sta ch_033
 291  413 	jmp L_040
 292  414 L_042
 293  418 	lda.w charcount_032,X
 294  419 	pha.w
 295  420 	lda #1
 296  421 	clc
 297  422 	adc.w 1,S
 298  423 	adj #2
 299  424 	sta.w charcount_032,X
 300  425 L_050
 301  426 	lda #20
 302  427 	cmp.w charcount_032,X
 303  428 	bge L_051
 304  429 	jmp L_052
 305  430 L_051
 306  432 	lda.w buffer_031,X
 307  433 	pha.w
 308  434 	lda.w charcount_032,X
 309  435 	dec.w a
 310  436 	clc
 311  437 	adc.w 1,S
 312  438 	sta.w 1,S
 313  439 	lda #32
 314  440 	pli
 315  441 	sta 0,I++
 316  443 	inc.w charcount_032,X
 317  444 	jmp L_050
 318  445 L_052
 319  446 	dec.w charcount_032,X
 320  449 	lda #1
 321  450 	sta.w gotword_015
 322  452 L_039
 323  454 	txs.w
 324  455 	plx.w
 325  456 	rts
 326  457 	.end readword_030
 327  468 lastnumberindex_054	.equ +7
 328  469 appendlinenumber_053	.sub
 329  470 	phx.w
 330  471 	tsx.w
 331  472 	adj #-4
 332  474 	lda.w nextnumberindex_010
 333  475 	pha.w
 334  476 	lda.w #1000
 335  477 	xma.w 1,S
 336  478 	cmp.w 1,S
 337  479 	adj #2
 338  480 	php
 339  481 	lda #1
 340  482 	plp
 341  483 	blt L_057
 342  484 	lda #0
 343  485 L_057
 344  486 	cmp.w #1
 345  487 	beq L_055
 346  488 	jmp  L_056
 347  489 L_055
 348  491 	lda.w lastnumberindex_054,X
 349  492 	pha.w
 350  493 	lda #0
 351  494 	xma.w 1,S
 352  495 	cmp.w 1,S
 353  496 	adj #2
 354  497 	php
 355  498 	lda #1
 356  499 	plp
 357  500 	bne L_060
 358  501 	lda #0
 359  502 L_060
 360  503 	cmp.w #1
 361  504 	beq L_058
 362  505 	jmp  L_059
 363  506 L_058
 364  508 	psh.w #numbertable_008
 365  509 	lda.w lastnumberindex_054,X
 366  510 	asl.w a
 367  511 	asl.w a
 368  512 	clc
 369  513 	adc.w 1,S
 370  514 	sta.w 1,S
 371  515 	pla.w
 372  516 	clc
 373  517 	adc.w #nextindex_006
 374  518 	pha.w
 375  519 	lda.w nextnumberindex_010
 376  520 	pli
 377  521 	sta.w 0,I++
 378  523 L_059
 379  525 	psh.w #numbertable_008
 380  526 	lda.w nextnumberindex_010
 381  527 	asl.w a
 382  528 	asl.w a
 383  529 	clc
 384  530 	adc.w 1,S
 385  531 	sta.w 1,S
 386  532 	pla.w
 387  533 	clc
 388  534 	adc.w #number_005
 389  535 	pha.w
 390  536 	lda.w linenumber_011
 391  537 	pli
 392  538 	sta.w 0,I++
 393  540 	psh.w #numbertable_008
 394  541 	lda.w nextnumberindex_010
 395  542 	asl.w a
 396  543 	asl.w a
 397  544 	clc
 398  545 	adc.w 1,S
 399  546 	sta.w 1,S
 400  547 	pla.w
 401  548 	clc
 402  549 	adc.w #nextindex_006
 403  550 	pha.w
 404  551 	lda #0
 405  552 	pli
 406  553 	sta.w 0,I++
 407  555 	lda.w nextnumberindex_010
 408  556 	sta.w RETURN_VALUE,X
 409  558 	lda.w nextnumberindex_010
 410  559 	pha.w
 411  560 	lda #1
 412  561 	clc
 413  562 	adc.w 1,S
 414  563 	adj #2
 415  564 	sta.w nextnumberindex_010
 416  567 	jmp L_061
 417  568 L_056
 418  570 	lda #1
 419  571 	sta.w numbertablefull_013
 420  573 	lda #0
 421  574 	sta.w RETURN_VALUE,X
 422  576 L_061
 423  578 	lda.w RETURN_VALUE,X
 424  579 	txs.w
 425  580 	plx.w
 426  581 	rts
 427  582 	.end appendlinenumber_053
 428  594 i_063	.equ -1
 429  595 enterword_062	.sub
 430  596 	phx.w
 431  597 	tsx.w
 432  598 	adj #-2
 433  603 	lda.w newline_014
 434  604 	cmp.w #1
 435  605 	beq L_064
 436  606 	jmp  L_065
 437  607 L_064
 438  608 	lda.w linenumber_011
 439  609 	pha.w
 440  610 	lda #1
 441  611 	xma.w 1,S
 442  612 	sec
 443  613 	sbc.w 1,S
 444  614 	adj #2
 445  615 	sta.w linenumber_011
 446  616 L_065
 447  620 	lda #1
 448  621 	sta.w i_063,X
 449  623 L_066
 450  624 	psh.w #wordtable_007
 451  625 	lda.w i_063,X
 452  626 	dec.w a
 453  627 	pha.w
 454  628 	psh.w #24
 455  629 	jsr _imul
 456  630 	adj #4
 457  631 	clc
 458  632 	adc.w 1,S
 459  633 	sta.w 1,S
 460  635 	pla.w
 461  636 	clc
 462  637 	adc.w #word_002
 463  638 	pha.w
 464  639 	psh.w #wordtable_007
 465  640 	lda.w nextwordindex_009
 466  641 	dec.w a
 467  642 	pha.w
 468  643 	psh.w #24
 469  644 	jsr _imul
 470  645 	adj #4
 471  646 	clc
 472  647 	adc.w 1,S
 473  648 	sta.w 1,S
 474  649 	pla.w
 475  650 	clc
 476  651 	adc.w #word_002
 477  652 	pha.w
 478  653 	psh.w #20
 479  654 	jsr _cmpsb
 480  655 	adj #+6
 481  656 	php
 482  657 	lda #1
 483  658 	plp
 484  659 	bne L_069
 485  660 	lda #0
 486  661 L_069
 487  662 	cmp.w #1
 488  663 	beq L_067
 489  664 	jmp L_068
 490  665 L_067
 491  667 	lda.w i_063,X
 492  668 	pha.w
 493  669 	lda #1
 494  670 	clc
 495  671 	adc.w 1,S
 496  672 	adj #2
 497  673 	sta.w i_063,X
 498  675 	jmp L_066
 499  676 L_068
 500  680 	lda.w i_063,X
 501  681 	pha.w
 502  682 	lda.w nextwordindex_009
 503  683 	xma.w 1,S
 504  684 	cmp.w 1,S
 505  685 	adj #2
 506  686 	php
 507  687 	lda #1
 508  688 	plp
 509  689 	blt L_072
 510  690 	lda #0
 511  691 L_072
 512  692 	cmp.w #1
 513  693 	beq L_070
 514  694 	jmp  L_071
 515  695 L_070
 516  697 	psh.w #wordtable_007
 517  698 	lda.w i_063,X
 518  699 	dec.w a
 519  700 	pha.w
 520  701 	psh.w #24
 521  702 	jsr _imul
 522  703 	adj #4
 523  704 	clc
 524  705 	adc.w 1,S
 525  706 	sta.w 1,S
 526  707 	pla.w
 527  708 	clc
 528  709 	adc.w #lastnumberindex_004
 529  710 	pha.w
 530  712 	psh.w #wordtable_007
 531  713 	lda.w i_063,X
 532  714 	dec.w a
 533  715 	pha.w
 534  716 	psh.w #24
 535  717 	jsr _imul
 536  718 	adj #4
 537  719 	clc
 538  720 	adc.w 1,S
 539  721 	sta.w 1,S
 540  722 	pla.w
 541  723 	clc
 542  724 	adc.w #lastnumberindex_004
 543  725 	pha.w
 544  726 	pli
 545  727 	lda.w 0,I++
 546  728 	pha.w
 547  729 	lda.w STATIC_LINK,X
 548  730 	pha.w
 549  731 	jsr appendlinenumber_053
 550  732 	adj #4
 551  733 	pli
 552  734 	sta.w 0,I++
 553  739 	jmp L_073
 554  740 L_071
 555  741 	lda.w nextwordindex_009
 556  742 	pha.w
 557  743 	lda.w #500
 558  744 	xma.w 1,S
 559  745 	cmp.w 1,S
 560  746 	adj #2
 561  747 	php
 562  748 	lda #1
 563  749 	plp
 564  750 	blt L_076
 565  751 	lda #0
 566  752 L_076
 567  753 	cmp.w #1
 568  754 	beq L_074
 569  755 	jmp  L_075
 570  756 L_074
 571  758 	lda.w nextwordindex_009
 572  759 	pha.w
 573  760 	lda #1
 574  761 	clc
 575  762 	adc.w 1,S
 576  763 	adj #2
 577  764 	sta.w nextwordindex_009
 578  766 	psh.w #wordtable_007
 579  767 	lda.w i_063,X
 580  768 	dec.w a
 581  769 	pha.w
 582  770 	psh.w #24
 583  771 	jsr _imul
 584  772 	adj #4
 585  773 	clc
 586  774 	adc.w 1,S
 587  775 	sta.w 1,S
 588  776 	pla.w
 589  777 	clc
 590  778 	adc.w #firstnumberindex_003
 591  779 	pha.w
 592  780 	lda #0
 593  781 	pha.w
 594  782 	lda.w STATIC_LINK,X
 595  783 	pha.w
 596  784 	jsr appendlinenumber_053
 597  785 	adj #4
 598  786 	pli
 599  787 	sta.w 0,I++
 600  789 	psh.w #wordtable_007
 601  790 	lda.w i_063,X
 602  791 	dec.w a
 603  792 	pha.w
 604  793 	psh.w #24
 605  794 	jsr _imul
 606  795 	adj #4
 607  796 	clc
 608  797 	adc.w 1,S
 609  798 	sta.w 1,S
 610  799 	pla.w
 611  800 	clc
 612  801 	adc.w #lastnumberindex_004
 613  802 	pha.w
 614  804 	psh.w #wordtable_007
 615  805 	lda.w i_063,X
 616  806 	dec.w a
 617  807 	pha.w
 618  808 	psh.w #24
 619  809 	jsr _imul
 620  810 	adj #4
 621  811 	clc
 622  812 	adc.w 1,S
 623  813 	sta.w 1,S
 624  814 	pla.w
 625  815 	clc
 626  816 	adc.w #firstnumberindex_003
 627  817 	pha.w
 628  818 	pli
 629  819 	lda.w 0,I++
 630  820 	pli
 631  821 	sta.w 0,I++
 632  826 	jmp L_077
 633  827 L_075
 634  828 	lda #1
 635  829 	sta.w wordtablefull_012
 636  830 L_077
 637  831 L_073
 638  834 	lda.w newline_014
 639  835 	cmp.w #1
 640  836 	beq L_078
 641  837 	jmp  L_079
 642  838 L_078
 643  839 	lda.w linenumber_011
 644  840 	pha.w
 645  841 	lda #1
 646  842 	clc
 647  843 	adc.w 1,S
 648  844 	adj #2
 649  845 	sta.w linenumber_011
 650  846 L_079
 651  848 	txs.w
 652  849 	plx.w
 653  850 	rts
 654  851 	.end enterword_062
 655  863 i_081	.equ -1
 656  864 j_082	.equ -3
 657  865 temp_083	.equ -27
 658  866 sortwords_080	.sub
 659  867 	phx.w
 660  868 	tsx.w
 661  869 	adj #-28
 662  871 	lda #1
 663  872 	sta.w i_081,X
 664  873 L_084
 665  874 	lda.w nextwordindex_009
 666  875 	pha.w
 667  876 	lda #2
 668  877 	xma.w 1,S
 669  878 	sec
 670  879 	sbc.w 1,S
 671  880 	adj #2
 672  881 	cmp.w i_081,X
 673  882 	bge L_085
 674  883 	jmp L_086
 675  884 L_085
 676  886 	lda.w i_081,X
 677  887 	pha.w
 678  888 	lda #1
 679  889 	clc
 680  890 	adc.w 1,S
 681  891 	adj #2
 682  892 	sta.w j_082,X
 683  893 L_087
 684  894 	lda.w nextwordindex_009
 685  895 	pha.w
 686  896 	lda #1
 687  897 	xma.w 1,S
 688  898 	sec
 689  899 	sbc.w 1,S
 690  900 	adj #2
 691  901 	cmp.w j_082,X
 692  902 	bge L_088
 693  903 	jmp L_089
 694  904 L_088
 695  906 	psh.w #wordtable_007
 696  907 	lda.w i_081,X
 697  908 	dec.w a
 698  909 	pha.w
 699  910 	psh.w #24
 700  911 	jsr _imul
 701  912 	adj #4
 702  913 	clc
 703  914 	adc.w 1,S
 704  915 	sta.w 1,S
 705  916 	pla.w
 706  917 	clc
 707  918 	adc.w #word_002
 708  919 	pha.w
 709  920 	psh.w #wordtable_007
 710  921 	lda.w j_082,X
 711  922 	dec.w a
 712  923 	pha.w
 713  924 	psh.w #24
 714  925 	jsr _imul
 715  926 	adj #4
 716  927 	clc
 717  928 	adc.w 1,S
 718  929 	sta.w 1,S
 719  930 	pla.w
 720  931 	clc
 721  932 	adc.w #word_002
 722  933 	pha.w
 723  934 	psh.w #20
 724  935 	jsr _cmpsb
 725  936 	adj #+6
 726  937 	php
 727  938 	lda #1
 728  939 	plp
 729  940 	bgt L_092
 730  941 	lda #0
 731  942 L_092
 732  943 	cmp.w #1
 733  944 	beq L_090
 734  945 	jmp  L_091
 735  946 L_090
 736  948 	txa.w
 737  949 	clc
 738  950 	adc.w #temp_083
 739  951 	pha.w
 740  952 	psh.w #wordtable_007
 741  953 	lda.w i_081,X
 742  954 	dec.w a
 743  955 	pha.w
 744  956 	psh.w #24
 745  957 	jsr _imul
 746  958 	adj #4
 747  959 	clc
 748  960 	adc.w 1,S
 749  961 	sta.w 1,S
 750  962 	swp x
 751  963 	lda #24
 752  964 	plx.w
 753  965 	ply.w
 754  966 	mov #15
 755  967 	swp x
 756  969 	psh.w #wordtable_007
 757  970 	lda.w i_081,X
 758  971 	dec.w a
 759  972 	pha.w
 760  973 	psh.w #24
 761  974 	jsr _imul
 762  975 	adj #4
 763  976 	clc
 764  977 	adc.w 1,S
 765  978 	sta.w 1,S
 766  979 	psh.w #wordtable_007
 767  980 	lda.w j_082,X
 768  981 	dec.w a
 769  982 	pha.w
 770  983 	psh.w #24
 771  984 	jsr _imul
 772  985 	adj #4
 773  986 	clc
 774  987 	adc.w 1,S
 775  988 	sta.w 1,S
 776  989 	swp x
 777  990 	lda #24
 778  991 	plx.w
 779  992 	ply.w
 780  993 	mov #15
 781  994 	swp x
 782  996 	psh.w #wordtable_007
 783  997 	lda.w j_082,X
 784  998 	dec.w a
 785  999 	pha.w
 786 1000 	psh.w #24
 787 1001 	jsr _imul
 788 1002 	adj #4
 789 1003 	clc
 790 1004 	adc.w 1,S
 791 1005 	sta.w 1,S
 792 1006 	txa.w
 793 1007 	clc
 794 1008 	adc.w #temp_083
 795 1009 	pha.w
 796 1010 	swp x
 797 1011 	lda #24
 798 1012 	plx.w
 799 1013 	ply.w
 800 1014 	mov #15
 801 1015 	swp x
 802 1017 L_091
 803 1019 	inc.w j_082,X
 804 1020 	jmp L_087
 805 1021 L_089
 806 1022 	dec.w j_082,X
 807 1024 	inc.w i_081,X
 808 1025 	jmp L_084
 809 1026 L_086
 810 1027 	dec.w i_081,X
 811 1029 	txs.w
 812 1030 	plx.w
 813 1031 	rts
 814 1032 	.end sortwords_080
 815 1040 i_094	.equ +7
 816 1041 printnumbers_093	.sub
 817 1042 	phx.w
 818 1043 	tsx.w
 819 1045 L_095
 820 1047 	psh.w #numbertable_008
 821 1048 	lda.w i_094,X
 822 1049 	asl.w a
 823 1050 	asl.w a
 824 1051 	clc
 825 1052 	adc.w 1,S
 826 1053 	sta.w 1,S
 827 1054 	pla.w
 828 1055 	clc
 829 1056 	adc.w #number_005
 830 1057 	pha.w
 831 1058 	pli
 832 1059 	lda.w 0,I++
 833 1060 	pha.w
 834 1061 	lda #4
 835 1062 	pha.w
 836 1063 	jsr _iwrite
 837 1064 	adj #4
 838 1066 	psh.w #numbertable_008
 839 1067 	lda.w i_094,X
 840 1068 	asl.w a
 841 1069 	asl.w a
 842 1070 	clc
 843 1071 	adc.w 1,S
 844 1072 	sta.w 1,S
 845 1073 	pla.w
 846 1074 	clc
 847 1075 	adc.w #nextindex_006
 848 1076 	pha.w
 849 1077 	pli
 850 1078 	lda.w 0,I++
 851 1079 	sta.w i_094,X
 852 1081 	lda.w i_094,X
 853 1082 	pha.w
 854 1083 	lda #0
 855 1084 	xma.w 1,S
 856 1085 	cmp.w 1,S
 857 1086 	adj #2
 858 1087 	php
 859 1088 	lda #1
 860 1089 	plp
 861 1090 	beq L_097
 862 1091 	lda #0
 863 1092 L_097
 864 1093 	cmp.w #1
 865 1094 	beq L_096
 866 1095 	jmp L_095
 867 1096 L_096
 868 1098 	jsr _writeln
 869 1100 	txs.w
 870 1101 	plx.w
 871 1102 	rts
 872 1103 	.end printnumbers_093
 873 1114 i_099	.equ -1
 874 1115 printxref_098	.sub
 875 1116 	phx.w
 876 1117 	tsx.w
 877 1118 	adj #-2
 878 1120 	jsr _writeln
 879 1122 	jsr _writeln
 880 1124 	psh.w #S_100
 881 1125 	psh.w #0
 882 1126 	psh.w #15
 883 1127 	jsr _swrite
 884 1128 	adj #6
 885 1129 	jsr _writeln
 886 1131 	psh.w #S_101
 887 1132 	psh.w #0
 888 1133 	psh.w #15
 889 1134 	jsr _swrite
 890 1135 	adj #6
 891 1136 	jsr _writeln
 892 1138 	jsr _writeln
 893 1140 	lda.w STATIC_LINK,X
 894 1141 	pha.w
 895 1142 	jsr sortwords_080
 896 1143 	adj #2
 897 1145 	lda #1
 898 1146 	sta.w i_099,X
 899 1147 L_102
 900 1148 	lda.w nextwordindex_009
 901 1149 	pha.w
 902 1150 	lda #1
 903 1151 	xma.w 1,S
 904 1152 	sec
 905 1153 	sbc.w 1,S
 906 1154 	adj #2
 907 1155 	cmp.w i_099,X
 908 1156 	bge L_103
 909 1157 	jmp L_104
 910 1158 L_103
 911 1160 	psh.w #wordtable_007
 912 1161 	lda.w i_099,X
 913 1162 	dec.w a
 914 1163 	pha.w
 915 1164 	psh.w #24
 916 1165 	jsr _imul
 917 1166 	adj #4
 918 1167 	clc
 919 1168 	adc.w 1,S
 920 1169 	sta.w 1,S
 921 1170 	pla.w
 922 1171 	clc
 923 1172 	adc.w #word_002
 924 1173 	pha.w
 925 1174 	psh.w #0
 926 1175 	psh.w #20
 927 1176 	jsr _swrite
 928 1177 	adj #6
 929 1179 	psh.w #wordtable_007
 930 1180 	lda.w i_099,X
 931 1181 	dec.w a
 932 1182 	pha.w
 933 1183 	psh.w #24
 934 1184 	jsr _imul
 935 1185 	adj #4
 936 1186 	clc
 937 1187 	adc.w 1,S
 938 1188 	sta.w 1,S
 939 1189 	pla.w
 940 1190 	clc
 941 1191 	adc.w #firstnumberindex_003
 942 1192 	pha.w
 943 1193 	pli
 944 1194 	lda.w 0,I++
 945 1195 	pha.w
 946 1196 	lda.w STATIC_LINK,X
 947 1197 	pha.w
 948 1198 	jsr printnumbers_093
 949 1199 	adj #4
 950 1201 	inc.w i_099,X
 951 1202 	jmp L_102
 952 1203 L_104
 953 1204 	dec.w i_099,X
 954 1206 	txs.w
 955 1207 	plx.w
 956 1208 	rts
 957 1209 	.end printxref_098
 958 1213 _pc65_main	.sub
 959 1214 	phx.w
 960 1215 	tsx.w
 961 1217 	lda #0
 962 1218 	sta.w wordtablefull_012
 963 1220 	lda #0
 964 1221 	sta.w numbertablefull_013
 965 1223 	lda #1
 966 1224 	sta.w nextwordindex_009
 967 1226 	lda #1
 968 1227 	sta.w nextnumberindex_010
 969 1229 	lda #1
 970 1230 	sta.w linenumber_011
 971 1232 	psh.w #S_105
 972 1233 	psh.w #0
 973 1234 	psh.w #8
 974 1235 	jsr _swrite
 975 1236 	adj #6
 976 1240 L_106
 977 1241 	jsr _eof
 978 1242 	pha.w
 979 1243 	lda.w wordtablefull_012
 980 1244 	ora.w 1,S
 981 1245 	adj #2
 982 1246 	pha.w
 983 1247 	lda.w numbertablefull_013
 984 1248 	ora.w 1,S
 985 1249 	adj #2
 986 1250 	eor #1
 987 1251 	cmp.w #1
 988 1252 	beq L_107
 989 1253 	jmp L_108
 990 1254 L_107
 991 1256 	psh.w #wordtable_007
 992 1257 	lda.w nextwordindex_009
 993 1258 	dec.w a
 994 1259 	pha.w
 995 1260 	psh.w #24
 996 1261 	jsr _imul
 997 1262 	adj #4
 998 1263 	clc
 999 1264 	adc.w 1,S
1000 1265 	sta.w 1,S
1001 1266 	pla.w
1002 1267 	clc
1003 1268 	adc.w #word_002
1004 1269 	pha.w
1005 1270 	phx.w
1006 1271 	jsr readword_030
1007 1272 	adj #4
1008 1274 	lda.w gotword_015
1009 1275 	cmp.w #1
1010 1276 	beq L_109
1011 1277 	jmp  L_110
1012 1278 L_109
1013 1279 	phx.w
1014 1280 	jsr enterword_062
1015 1281 	adj #2
1016 1282 L_110
1017 1284 	jmp L_106
1018 1285 L_108
1019 1289 	lda.w wordtablefull_012
1020 1290 	cmp.w #1
1021 1291 	beq L_111
1022 1292 	jmp  L_112
1023 1293 L_111
1024 1295 	jsr _writeln
1025 1297 	psh.w #S_113
1026 1298 	psh.w #0
1027 1299 	psh.w #43
1028 1300 	jsr _swrite
1029 1301 	adj #6
1030 1302 	jsr _writeln
1031 1305 	jmp L_114
1032 1306 L_112
1033 1307 	lda.w numbertablefull_013
1034 1308 	cmp.w #1
1035 1309 	beq L_115
1036 1310 	jmp  L_116
1037 1311 L_115
1038 1313 	jsr _writeln
1039 1315 	psh.w #S_117
1040 1316 	psh.w #0
1041 1317 	psh.w #45
1042 1318 	jsr _swrite
1043 1319 	adj #6
1044 1320 	jsr _writeln
1045 1323 	jmp L_118
1046 1324 L_116
1047 1326 	phx.w
1048 1327 	jsr printxref_098
1049 1328 	adj #2
1050 1330 L_118
1051 1331 L_114
1052 1335 	jsr _writeln
1053 1337 	lda.w nextwordindex_009
1054 1338 	pha.w
1055 1339 	lda #1
1056 1340 	xma.w 1,S
1057 1341 	sec
1058 1342 	sbc.w 1,S
1059 1343 	adj #2
1060 1344 	pha.w
1061 1345 	lda #5
1062 1346 	pha.w
1063 1347 	jsr _iwrite
1064 1348 	adj #4
1065 1349 	psh.w #S_119
1066 1350 	psh.w #0
1067 1351 	psh.w #14
1068 1352 	jsr _swrite
1069 1353 	adj #6
1070 1354 	jsr _writeln
1071 1356 	lda.w nextnumberindex_010
1072 1357 	pha.w
1073 1358 	lda #1
1074 1359 	xma.w 1,S
1075 1360 	sec
1076 1361 	sbc.w 1,S
1077 1362 	adj #2
1078 1363 	pha.w
1079 1364 	lda #5
1080 1365 	pha.w
1081 1366 	jsr _iwrite
1082 1367 	adj #4
1083 1368 	psh.w #S_120
1084 1369 	psh.w #0
1085 1370 	psh.w #21
1086 1371 	jsr _swrite
1087 1372 	adj #6
1088 1373 	jsr _writeln
1089 1376 	plx.w
1090 1377 	rts
1091 1378 	.end _pc65_main
1092 1380 	.dat
1093 1382 wordtable_007	.byt 12000
1094 1383 numbertable_008	.byt 4004
1095 1384 nextwordindex_009	.byt 2
1096 1385 nextnumberindex_010	.byt 2
1097 1386 linenumber_011	.byt 2
1098 1387 wordtablefull_012	.byt 2
1099 1388 numbertablefull_013	.byt 2
1100 1389 newline_014	.byt 2
1101 1390 gotword_015	.byt 2
1102 1391 S_120	.str " line number entries."
1103 1392 S_119	.str " word entries."
1104 1393 S_117	.str "*** The number table is not large enough. ***"
1105 1394 S_113	.str "*** The word table is not large enough. ***"
1106 1395 S_105	.str "    1 : "
1107 1396 S_101	.str "---------------"
1108 1397 S_100	.str "Cross-reference"
1109 1398 S_020	.str " : "
1110 1400 	.end
